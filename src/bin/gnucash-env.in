#!/bin/sh
exec @-GUILE-@ -s "$0" "$@"
!#

;; Usage: gnucash-env any-cmd [ args ... ]
;; runs any-cmd in an environment appropriate for gnucash.
;; we'll also add a gnucash-build-env later for running from the install tree.

;; Don't put any envt settings, etc above in /bin/sh section --
;; otherwise, we can't invoke this directly from within an interactive
;; guile and have it work (for debugging).

(setenv "LD_LIBRARY_PATH"
        (apply string-append
               (or (getenv "LD_LIBRARY_PATH") "")
               (list ":"
                     "@-GNC_LIB_INSTALLDIR-@"
                     ":"
                     "@-GNC_PKGLIB_INSTALLDIR-@"
                     ":"
                     "@-GNC_MODULE_DIR-@")))

(setenv "GNC_MODULE_PATH"
        (apply string-append
               (or (getenv "GNC_MODULE_PATH") "")
               (list ":" "@-GNC_PKGLIB_INSTALLDIR-@")))

(setenv "GUILE_LOAD_PATH"
        (apply string-append
               (or (getenv "GUILE_LOAD_PATH") "")
               (list
                ":"
                "@-G_WRAP_MODULE_DIR-@"
                ":"
                "@-GNC_GUILE_MODULE_DIR-@"
                ":"
                "@-GNC_SCM_INSTALL_DIR-@")))

(setenv "PATH"
        (apply string-append
               "@-GNC_SCRIPT_OVERRIDE_DIR-@"
               ":"
               (list (or (getenv "PATH") ""))))

(if (null? (program-arguments))
    (exit 0)
    (apply execlp (cadr (program-arguments)) (cdr (program-arguments))))

;; Local Variables:
;; mode: scheme
;; End:
