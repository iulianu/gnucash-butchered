#!/bin/sh
exec gnucash-env guile -s $0 "$@"
!#

(let ((lib (if (or (string=? (version) "1.3")
                   (string=? (version) "1.3.4"))
               (dynamic-link "libgncguile.so")
               (dynamic-link "libgncguile"))))
  (if lib
      (dynamic-call "gnc_setup_gettext" lib)
      (begin
        (display "Can't load libgncguile.  Aborting.\n")
        (exit 1))))

(use-modules (gnucash bootstrap))

;; UGLY HACK -- FIXME -- code should be rewritten to not need this.
;; In particular, we should be using gnc_scm_lookup where we're using
;; gh_lookup or gh_eval_str now.
(set-current-module (resolve-module '(gnucash bootstrap)))

(gnc:main)

;; Local Variables:
;; mode: scheme
;; End:
