;;;; startup.scm -*-scheme-*-
;;
;; Minimal startup code.  This file should just contain enough code to
;; get the arguments parsed and things like gnc:*load-path* set up.
;; After that *everything* should be loaded via gnc:load.

;; This load should go away when guile gets fixed.  as of guile1.3,
;; it's not.  You have to do this manually, unless you call scm_shell,
;; which we can't.
(let ((boot-file (if (assoc 'prefix %guile-build-info)
		     (string-append (cdr (assoc 'prefix %guile-build-info))
				    "/share/guile/"
				    (version)
				    "/ice-9/boot-9.scm")
                     "/usr/share/guile/1.3a/ice-9/boot-9.scm")))
  (primitive-load boot-file))

;; Automatically generated defaults...
(define gnc:_config-dir-default_ "@GNC_RUNTIME_CONFIGDIR@")
(define gnc:_share-dir-default_ "@GNC_RUNTIME_SHAREDIR@")

(let ((lowlev-files
       '("utilities.scm"
         "config-var.scm"
         "path.scm"
         "prefs.scm"
         "command-line.scm"
         "main.scm")))
  
  (for-each (lambda (filename)
              (display "loading startup file ")
              (display (string-append gnc:_startup-dir-default_ "/" filename))
              (newline)

              (primitive-load
               (string-append gnc:_startup-dir-default_ "/" filename)))
            lowlev-files))
