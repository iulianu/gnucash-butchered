
SQL Tables
----------
These mostly parallel the data structures in the gnc engine.
See gnc-init.txt for more info.


Session Table, Session Modes
----------------------------
There are three basic modes for accessing the database:
"Single User",  "Polled Multi-User" and "Event-Driven Multi-User"
The session table in the database indicates which mode the database is
functioning.

-- "Single User File Mode" -- 
   Only one user can have access to the database at a time.  The
   database is used as a glorified file: engine data is 'saved' to
   the database only when the user selects 'save' from the GUI
   dialog.  This mode exists because it is easy to implement, easy 
   to debug, and has reasonable demands on the database for small
   datasets.

   This mode is guarenteed to clobber any sort of changes made by
   other users (in the same way that multiple file writers clobber
   each other).  Thus, this mode is mutually exclusive of any other,
   and te engine prevents more than one concurrent user.  


-- "Single User Update Mode" -- 
   Similar to the "Single User File Mode", except that updates
   are stored in the DB as they are made (thus eliminating the 
   need for a big 'save' at the end of a session).  This mode is 
   more robust in that there is minimal/no data loss in the event 
   of a crash.

-- "Multi-User Polled" -- 
   Multiple users are assumed, Gnucash polls the database to detect 
   changes in the data.  Partially Implemented. 


-- "Multi-User Events" --
   Gnucash uses the SQL LISTEN/NOTIFY async message delivery routines.
   Not implemented.


Session Design Notes
--------------------
The pgendSyncSingleFile() subroutine performs the equivalent of 'file
save'.  Note that it does this by deleting the entire contents of the 
database, and then writing out the entire contents of the engine.  It
works this way (needs to work this way) in order to make sure that
deleted transactions,etc. are really deleted from the database.  This
is because in this mode, the backend never finds out about deletions.
If you want incremental deletion, then use the 'Single Update' mode.

