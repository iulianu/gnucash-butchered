# Makefile -- makefile for gnucash/src/gnome                         
# Copyright (C) 1997 Robin Clark                                   
# Copyright (C) 1998 Linas Vepstas                                 
# Copyright (C) 1998 Rob Browning <rlb@cs.utexas.edu>
#                                                                  
# This program is free software; you can redistribute it and/or    
# modify it under the terms of the GNU General Public License as   
# published by the Free Software Foundation; either version 2 of   
# the License, or (at your option) any later version.              
#                                                                  
# This program is distributed in the hope that it will be useful,  
# but WITHOUT ANY WARRANTY; without even the implied warranty of   
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the    
# GNU General Public License for more details.                     
#                                                                  
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software      
# Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.        
#                                                                  
#   Author: Robin Clark                                            
# Internet: rclark@rush.aero.org                                   
#  Address: 609 8th Street                                         
#           Huntington Beach, CA 92648-4632                        

include @top_srcdir@/Makefile.init

GTKSHEET_DIR := @GTKSHEET_DIR@

INCLPATH := -I.. \
            -I../.. \
            -I../guile \
            -I../engine \
            -I../register \
            -I../reports \
            -I@srcdir@/../../include \
            -I${includedir} \
            -I../../lib/gtkfilesel2

# All the other GNOME CFLAGS are handled in Makefile.common now
CFLAGS   = @CFLAGS@ ${INCLPATH}
LDFLAGS  = @LDFLAGS@

GUILELIBS = @GUILELIBS@
LIBS     = -L$(prefix)/lib @LIBS@ -lgtkxmhtml \
           $(shell ${GNOME_CONFIG_BIN} --libs gnomeui) $(GUILELIBS)

ifeq (${HAVE_PLOTUTILS},1)
  LIBS += @PLOTUTILS_LIBS@
endif

# Have to use wildcard here otherwise filters below won't get the expanded
# text to work on...
OTHER_OBJS += $(wildcard @top_srcdir@/lib/${GTKSHEET_DIR}/obj/gnome/*.o)
OTHER_OBJS += $(wildcard @top_srcdir@/lib/gtkfilesel2/obj/gnome/*.o)
OTHER_OBJS += $(wildcard @top_srcdir@/src/obj/gnome/*.o)
OTHER_OBJS += $(wildcard @top_srcdir@/src/engine/obj/*.o)
OTHER_OBJS += $(wildcard @top_srcdir@/src/register/obj/gnome/*.o)
OTHER_OBJS += $(wildcard @top_srcdir@/src/reports/obj/*.o) 
OTHER_OBJS += $(wildcard @top_srcdir@/src/guile/obj/*.o)
OTHER_OBJS += @top_srcdir@/src/swig/guile/obj/gnome/gnucash-gnome-guile_wrap.o
OTHER_OBJS += $(wildcard @top_srcdir@/src/swig/obj/*.o)

######################################################################
# See Makefile.common for information about these variables.
GNOME_SRCS := top-level.c window-main.c window-register.c window-adjust.c \
              window-help.c \
              ui-callbacks.c window-reconcile.c window-main-menu.c \
              dialog-options.c dialog-filebox.c \
              dialog-add.c dialog-edit.c dialog-editnotes.c
######################################################################

all: gnome

# This inclusion must come after the first target, and after the
# definitions of *_SRCS, etc., but before the usage of *_OBJS.
include @top_srcdir@/Makefile.common

gnome: @top_srcdir@/gnucash.gnome
@top_srcdir@/gnucash.gnome: ${GNOME_OBJS} ${OTHER_OBJS}
	$(CC) $(LDFLAGS) -o $@ $^ $(LIBS)

gnome.static: @top_srcdir@/gnucash.gnome.static
@top_srcdir@/gnucash.motif.static: ${GNOME_OBJS} ${OTHER_OBJS}
	$(CC) -static $(LDFLAGS) -o $@ $^ $(LIBS)
