2006-03-09  Christian Stimming <stimming@tuhh.de>

	* lib/libqof/qof/qoflog.c, lib/libqof/qof/gnc-date.c,
	src/engine/Transaction.c: Add substitution code for unavailable
	functions gettimeofday and gmtime_r.

	* configure.in, Makefile.am: Replace "ln -sf" by "$(LN_S) -f" for
	systems that don't have symbolic links available.

	* configure.in, src/gnome-utils/gnc-druid-provider-file-gnome.h:
	Check for <glob.h> and provide own typedef if header unavailable.

	* configure.in, src/gnome-utils/gnc-gnome-utils.c: Check for
	<X11/Xlib.h> and ignore code section if header unavailable.

	* po/glossary/vi.po: Updated vietnamese glossary by Clytie Siddall
	<clytie@riverland.net.au>

2006-03-09  David Hampton  <hampton@employees.org>

	* src/engine/gw-engine-spec.scm:
	* src/engine/Group.c:
	* lib/libqof/qof/qofquery.c:
	* lib/libqof/qof/qofsession.c: Remove more functions to be
	deprecated in libqof2. (Pass Three - more trivial substitutions
	and simple translations.)

	* numerous: Never include "config.h" from a header file. Doing so
	makes it nigh impossible to override configuration settings.

2006-03-08  David Hampton  <hampton@employees.org>

	* numerous: Remove more functions to be deprecated in
	libqof2. (Pass Two - more trivial substitutions, some simple
	translations.)

	* numerous: Remove functions to be deprecated in libqof2. (Pass
	One - trivial substitutions.)

	* src/gnome-utils/gnc-tree-model-account.c:
	* src/engine/Account.c:
	* src/engine/Group.c: Remove extra events added in r13483.  This
	leaves the REMOVE event as the only changed event.

2006-03-08  Derek Atkins  <derek@ihtfp.com>

	* src/engine/gnc-filepath-utils.c:
	  gstdio.h and g_mkdir are in glib-2.6 -- use old APIs with glib-2.4.

	* lib/libqof/qof/qofevent.[ch]:
	  Fix the definition of QOF_EVENT_BASE; use QOF_EVENT__LAST for tests.

	* src/engine/gnc-event.h:
	  Add GNC_EVENT_ITEM_ADDED and GNC_EVENT_ITEM_REMOVED event definitions
	* src/engine/Split.c:
	  Emit GNC_EVENT_ITEM_ADDED and GNC_EVENT_ITEM_REMOVED events
	  when a split is added or removed from an account.
	* configure.in: depend on QOF 0.6.3 for proper event handling.

2006-03-08   Christian Stimming <stimming@tuhh.de>

	* src/gnc-module/gnc-module.c, src/backend/file/sixtp-utils.c:
	Replace setenv() by g_setenv for increased cross-platform
	compatibility.

	* src/engine/gnc-filepath-utils.c: Replace mkdir by g_mkdir for
	increased cross-platform compatibility.

	* src/core-utils/gnc-gconf-utils.c,
	src/business/business-gnome/business-urls.c
	src/gnome-utils/dialog-preferences.c
	src/gnome-utils/gnc-currency-edit.c
	src/gnome-utils/gnc-plugin-file-history.c
	src/gnome-utils/gnc-main-window.c
	src/gnome-utils/dialog-reset-warnings.c
	src/gnome-utils/gnc-tree-view.c src/gnome/window-reconcile.c
	src/app-utils/file-utils.c src/app-utils/gnc-ui-util.c : Replace
	index(3) by strchr(3) and rindex(3) by strrchr(3) because the
	latter is more widely available.

2006-03-07  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-splash.c: Use a font size of "smaller" when
	printing to the splash screen. Should solve 104436 except for
	people running with huge system fonts.

	* src/gnome-utils/gnc-tree-view-account.[ch]: Relabel column
	titles from "XXX (Report)" to a label that includes the currency
	mnemonic (e.g. "Total (EUR)"). Closes 118695.

	* src/app-utils/gnc-ui-util.c:
	* src/engine/gnc-hooks.[ch]: Cache the result of a gconf lookup
	for a currency choice.  Add a new callback hook for when a user
	changes a currency setting (default account or report).

	* src/register/register-gnome/combocell-gnome.c:
	* src/register/register-gnome/gnucash-item-list.[ch]:
	* src/register/register-gnome/gnucash-item-edit.[ch]:
	* src/register/ledger-core/gnc-ledger-display.c:
	* src/register/ledger-core/split-register.h:
	* src/register/ledger-core/split-register-load.c:
	* src/register/register-core/combocell.h:
	* src/gnome-utils/account-quickfill.[ch]: The account quickfill
	has multiple components to it, only one of which was shared. Build
	and use a shared list store used by the gnucash_item_edit
	widget (which is updated by signals sent when accounts are
	added/deleted/modified.)  With this in place, its not necessary to
	rebuild two account quickfills for each open register window when
	a gnc_gui_resume_refresh is called which eliminates an O(2n)
	slowdown.  This seems sufficient to close 120028.

	* src/gnome/dialog-price-editor.c:
	* src/gnome/top-level.c:
	* src/gnome/dialog-commodities.c:
	* src/gnome/dialog-price-edit-db.c:
	* src/gnc-ui.h: Remove all usage of gnc_get_current_session / book
	/ whatever except at the very top level when the dialog is
	originally created. Tell the component manager to delete the
	dialog when the session is destroyed. Remove support for an old
	url-that-generates-a-price-edit-window trick.

	* src/gnome-utils/gnc-file.c: Add a couple of calls to the
	component manager when closing the current session.

	* src/engine/gnc-pricedb.c: Use the pointer to the commodity as a
	hash key instead of looking up the commodity string and then
	hashing that.  Fixes 332678.

2006-03-08  Andreas Köhler  <andi5.py@gmx.net>

	* configure.in: 
	* lib/libqof/qof/guid.c: Add configure test for sys/times.h and
	  corrected guid.c to check for that.

2006-03-07  Christian Stimming  <stimming@tuhh.de>

	* lib/libqof/qof/guid.c: Make seed collection parts that depend on
	particular functions #ifdef'd on that to enable easier
	windows/mingw32 porting.

	* lib/libc/setenv.h: Fix old libc substitution files, now needed
	for windows/mingw32 porting.

	* Makefile.am: Add po/gnucash.pot to EXTRA_DIST because the
	translation template is needed in the tarball for translators.

2006-03-07  Andreas Köhler  <andi5.py@gmx.net>

	* src/gnome/gnc-plugin-page-register.c: Disable sensitivity of
	  style radio actions for registers with ledger_type != LD_SINGLE.

2006-03-07  Derek Atkins  <derek@ihtfp.com>

	* lib/libgsf-1.12.3/tests/test-msole1.c:
	  properly ignore the return value of fgets().  Fixes an FC4 error.

2006-03-06  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/glade/sched-xact.glade: Change initial sensitivity of
	auto-create+notify SX pref.

	* src/gnome/dialog-sxsincelast.c (create_each_transaction_helper):
	Add multi-commodity SX support.  Bug#333532.

	* packaging/gnucash-1.9.x.ebuild (SRC_URI): Mods for ebuild to be
	used as an SVN ebuild.

2006-03-06  Andreas Köhler  <andi5.py@gmx.net>

	* src/gnome-utils/gnc-html-graph-gog.c: Save the go graph in the
	  GtkHTMLEmbedded object. Add printing support for the graphs
	  (depends on #332884). A bit of formatting.

	* src/gnome-utils/gnc-html.[ch]: Correct prototype of
	  GncHTMLObjectCB to return gboolean.

	* src/gnome-utils/print-session.[ch]: Create a new job with a
	  default config for the print dialog. Remove GnomePrintPaper
	  *paper from the PrintSession.

2006-03-06  Christian Stimming  <stimming@tuhh.de>

	* src/import-export/ofx/gnc-ofx-import.c: Fix OFX import problem
	with some dividends transactions. Patch by David Reiser. #164645.

	* src/import-export/import-backend.c: Fix crash when "clear" is
	chosen but no matching transaction is selected. Now those imported
	transactions will silently be ignored. #317917.

2006-03-05  Chris Lyttle  <chris@wilddev.net>

	* NEWS: Added some text about the release.
	* configure.in: Change to version 1.9.2

2006-03-05  David Hampton  <hampton@employees.org>

	* src/engine/Transaction.c:
	* src/engine/Split.c: Use utf8 collation routines when sorting
	splits in a register.  Also, only sort on the date of
	transactions (not date and time) since gnucash doesn't allow times
	to be input.  Fixes #127809.

2006-03-05  Joshua Sled  <jsled@asynchronous.org>

	* packaging/gnucash-1.9.x.ebuild: Add checks for libgsf and
	goffice being built_with_use gnome.  Add code to shutdown any
	user-level gconfd's running.  Add note about broken
	make_desktop_entry.  Expand range of README installs.

	* src/app-utils/test/test-exp-parser.c (test_parser): Hack-fix
	test errors due to missing function now required by
	expression-parser.  In the future, we should have a better way to
	setup the application/test state.

	* src/calculation/expression_parser.c (primary_exp): Fix
	function-parsing bug I introduced during the week with another bug
	fix.

2006-03-05  Derek Atkins  <derek@ihtfp.com>

	* src/register/ledger-core/split-register.c:
	* src/register/ledger-core/split-register-load.c:
	* src/register/ledger-core/split-register-control.c:
	  Fix a compiler warning so the code builds properly:
	  - warning: suggest parentheses around assignment used as truth value

	* configure.in: change the g-wrap 1.3 + GCC4 behavior.
	  only warn the user (not blow out) if they explicitly request
	  --enable-error-on-warning.   But still blow out if they
	  didn't specifically request it and we turned it on by default.

2006-03-05  Christian Stimming  <stimming@tuhh.de>

	* src/register/ledger-core/split-register-control.c: Fix missing
	variable initialization in Chris' changes.

2006-03-04  David Hampton  <hampton@employees.org>

	* src/register/ledger-core/gnc-ledger-display.[ch]:
	* src/register/ledger-core/split-register.c:
	* src/gnome/gnc-plugin-page-register.c: Move/fix the callbacks
	function that kills any open registers for an account that has had
	"extreme" changes made to it in the "edit account" dialog.  Fixes
	331415.

	* src/pixmaps/*
	* src/gnome-utils/Makefile.am:
	* src/gnome-utils/gnc-icons.[ch]:
	* src/gnome-utils/gnc-dir.h.in:
	* src/gnome/gnc-plugin-page-register.c:
	* src/gnome/ui/*: Consolidate the new icons with the existing set
	of icons.

	* src/gnome-utils/gnc-tree-model-account.c:
	* src/engine/Account.c:
	* src/engine/Group.c: Rework the events generated by the
	account/group files and consumed by the GncTreeModelAccount.
	Should eliminate all g_value_unset and g_object_set_property
	warnings related to changes in the account tree.

	* src/engine/Transaction.c:
	* src/engine/gnc-event.h: Rename a data structure field.

	* src/gnome-utils/dialog-account.c: Fix duplicate account name
	checking bug that prevented editing account info.

2006-03-04  Andreas Köhler  <andi5.py@gmx.net>

	* src/gnome/glade/account.glade: set automatic policy on some
	  scrolledwindows in the account dialog

	* glade-fixup: 
	* src/gnome/glade/account.glade: 
	* src/gnome/glade/budget.glade: 
	* src/gnome/glade/price.glade: 
	* src/gnome/glade/print.glade: 
	  remove add_tearoffs property from GtkComboBoxes

	* Hello_ChangeLog

2006-03-04  David Hampton  <hampton@employees.org>

	* src/gnome-utils/dialog-account.c:
	* lib/glib26/gkeyfile.c:
	* lib/glib26/gutils26.[ch]: Make g_strv_length available outside
	of the gkeyfile compatability library.

2006-03-04  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/schemas/Makefile.am (install-data-local)
	* src/gnome-utils/schemas/Makefile.am (install-data-local)
	* src/business/business-gnome/schemas/Makefile.am (install-data-local)
	* src/import-export/hbci/schemas/Makefile.am (install-data-local)
	* src/import-export/schemas/Makefile.am (install-data-local):
	Modify schema mkdirs by DESTDIR for packaging.

	* src/gnome/glade/sched-xact.glade: Fix selection mode on
	transaction reminder and obsolete SX lists.

	* src/gnome/ui/icon-split.png: 
	* src/gnome/ui/icon-transfer.png: 
	Add split, transfer icons provided by Andrew Duggan
	<cmkrnl@speakeasy.net>.
	
	* src/gnome-utils/gnc-dir.h.in: 
	* src/gnome-utils/Makefile.am (gnc-dir.h):
	* src/gnome/gnc-plugin-page-register.c
	(gnc_plugin_page_register_actions)
	(gnc_plugin_page_register_class_init): Add registration, use of
	gnucash-provided (split, transactions) icons.  Bug#327647.

	* src/gnome-utils/gnc-menu-extensions.c (gnc_extension_path):
	Fixes to memory deallocation suggested by Phil Longstaff
	<plongstaff@newearth.org>.

2006-03-04  David Hampton  <hampton@employees.org>

	* src/gnome-utils/dialog-preferences.c:
	* src/gnome-utils/glade/preferences.glade:
	* src/gnome/schemas/apps_gnucash_general.schemas.in:
	* src/engine/Account.c:
	* src/app-utils/gnc-ui-util.c: Update the preferences dialog to
	allow any unicode character as the separator.

r13487 | chris | 2006-03-04 23:14:38 -0500 (Sat, 04 Mar 2006) | 5 lines

   M /gnucash/trunk/src/engine/Scrub.c
   M /gnucash/trunk/src/engine/Split.c
   M /gnucash/trunk/src/engine/Transaction.c
   M /gnucash/trunk/src/register/ledger-core/split-register-control.c
   M /gnucash/trunk/src/register/ledger-core/split-register-load.c
   M /gnucash/trunk/src/register/ledger-core/split-register.c

   Convert xaccTransGetSplit() and xaccTransCountSplits() to return the
   index and count reflective of any in-progress edit.
   Convert some split iterators from directly using the GList of Splits to 
   using xaccTransGetSplit().

r13476 | chris | 2006-03-04 13:12:34 -0500 (Sat, 04 Mar 2006) | 4 lines

   M /gnucash/trunk/src/engine/engine-interface.scm

   Use for-each, lambda expressions for iterating over split lists.
   In contrast to the previous looping construct, this will work even if 
   the split operations don't have side-effects on the split lists.

r13471 | chris | 2006-03-04 01:56:27 -0500 (Sat, 04 Mar 2006) | 3 lines

   M /gnucash/trunk/src/engine/Transaction.c

   When the book is shutting down, don't be so eager to destroy the whole
   transaction.  This makes it easier to safely iterate over a split list.

r13469 | chris | 2006-03-04 00:10:15 -0500 (Sat, 04 Mar 2006) | 2 lines

   M /gnucash/trunk/src/engine/Transaction.c

   Destroy Transactions without rebalancing when shutting down the book.

r13468 | chris | 2006-03-03 22:21:34 -0500 (Fri, 03 Mar 2006) | 5 lines

   M /gnucash/trunk/src/engine/Makefile.am
   M /gnucash/trunk/src/engine/Transaction.c
   A /gnucash/trunk/src/engine/gnc-event.h

   Generate REMOVE events when a Split is removed from a Transaction.
   Pass the *old* parent transaction (since the Split may be moving into 
   a new transaction) and the old index of the Split in the old Transaction's
   list of Splits.

r13466 | chris | 2006-03-03 21:42:49 -0500 (Fri, 03 Mar 2006) | 2 lines

   M /gnucash/trunk/src/engine/Scrub.c

   Look for orphan Splits even when there is no Transaction imbalance.

r13465 | chris | 2006-03-03 19:27:38 -0500 (Fri, 03 Mar 2006) | 2 lines

   D /gnucash/trunk/src/gnome-utils/dialog-exchange.h

   Delete unused dialog-exchange.h

r13464 | chris | 2006-03-03 19:23:07 -0500 (Fri, 03 Mar 2006) | 3 lines

   M /gnucash/trunk/src/register/ledger-core/split-register-control.c
   M /gnucash/trunk/src/register/ledger-core/split-register.c

   Remove an unnecessary Account edit-block.
   Minor control-flow simplification.

r13463 | chris | 2006-03-03 19:13:15 -0500 (Fri, 03 Mar 2006) | 2 lines

   M /gnucash/trunk/src/register/ledger-core/split-register-load.c

   Bits to let the register see the in-progress Transaction edit.

r13462 | chris | 2006-03-03 19:11:44 -0500 (Fri, 03 Mar 2006) | 16 lines

   M /gnucash/trunk/src/engine/Account.c
   M /gnucash/trunk/src/engine/Account.h
   M /gnucash/trunk/src/engine/AccountP.h

   Remove xaccAccountRemoveSplit, and xaccAccountInsertSplit.
   (Actually, xaccAccountInsertSplit is #def'd to xaccSplitSetAccount().)
   Accounts no longer manage their Split lists.  The Account split lists
   should only ever be modified from within xaccTransCommitEdit().  This
   simplifies some of the operations on Accounts, since they can now be 
   expressed in terms of operations on Splits.

   Also, the consolidation of two operations (RemoveSplit and InsertSplit) 
   into one operation (xaccSplitSetAccount) means that it's no longer 
   possible to orphan a Split.

   Incidental:
      Fix a leak of a KVP frame.
      Don't recompute the account balance if we're shutting down.


r13461 | chris | 2006-03-03 19:11:16 -0500 (Fri, 03 Mar 2006) | 14 lines

   M /gnucash/trunk/src/engine/Transaction.c

   The xaccTransRollbackEdit() part of the Begin/Commit edit-block rewrite.  
   Broken out just for clarity.

   Note: There's one piece that I didn't change that I think is conceptually
   awkward.  It has to do with how/when we would discover that another
   user has deleted the transaction we're currently editing.  I think it makes
   more sense to detect and handle this case in xaccTransCommitEdit() instead
   of xaccTransRollbackEdit(), because (a) we don't actually have to do the 
   rollback if we just destroy the trans, (b) some rollbacks are not backend-
   induced, but rather voluntary, (c) we need a generalized mechanism
   anyway for detecting and handling deleted transactions even when
   we're not editing them.


r13460 | chris | 2006-03-03 19:10:44 -0500 (Fri, 03 Mar 2006) | 5 lines

   M /gnucash/trunk/src/engine/Scrub.c

   Move one data-validation function from Scrub.c into Transaction.c
   One simplification in xaccTransScrubImbalance() to always find the root
   AccountGroup from the Transaction's book.


r13459 | chris | 2006-03-03 19:10:12 -0500 (Fri, 03 Mar 2006) | 31 lines

   M /gnucash/trunk/src/engine/Transaction.c
   M /gnucash/trunk/src/engine/Transaction.h

   A good bit of notes about how the Transaction Begin/Commit
   edit-blocks should work, and why. 

   Converts the very important xaccTransCommitEdit function to use the 
   qof_commit_edit_part2() function instead of something that is 90%
   similar.

   Transactions have a Split list that keeps track of Splits during the edit.
   During edits, this list only grows and never shrinks.  Splits that
   have been destroyed or reparented to other transactions remain in
   the list, along with pre-edit Splits and newly added Splits.  Only after a 
   successful commit does the Split list drop reparented or destroyed
   Splits.  A couple out-of-engine users (mainly the register) call
   xaccTransGetSplitList() an work from the Transaction's split list,
   but they expect to be working with only the Splits that would still be in 
   the Transaction if the in-progress edit would be committed.  So, we
   provide the function xaccTransStillHasSplit(t, s) to allow users to query 
   the in-edit state of the Transaction's Split list.

   xaccTransRemoveSplit() and xaccTransInsertSplit() have been replaced by
   xaccSplitSetParent().

   The new xaccTransCommitEdit tries to take a more conservative approach
   to event generation, too.  Instead of generating every possible event for 
   any commit, it should generate only events that indicate a change to an 
   engine object or relation.

   Move some of the financial-constraint-enforcing functions closer to the 
   relevant data-structures. (from Scrub.c)


r13458 | chris | 2006-03-03 19:09:31 -0500 (Fri, 03 Mar 2006) | 9 lines

   M /gnucash/trunk/src/engine/test/test-period.c
   M /gnucash/trunk/src/engine/test/test-split-vs-account.c
   M /gnucash/trunk/src/engine/test-core/test-engine-stuff.c

   Remove some testing of an engine API that has been removed.
   The engine used to have functions that made it possible to orphan a Split.
   As this is no longer possible, we can't test anymore.

   Incidental:
      Fix three or four small leaks in the test functions.
      Allow test-period to be randomized based on optional command-line arg.


r13457 | chris | 2006-03-03 19:09:03 -0500 (Fri, 03 Mar 2006) | 27 lines

   M /gnucash/trunk/src/engine/Split.c
   M /gnucash/trunk/src/engine/Split.h
   M /gnucash/trunk/src/engine/SplitP.h

   Splits can now keep track of their own rollback state.
   The Split <-> Account and Split <-> Transaction relationships are now
   treated as properties of the Split.  In terms of the BeginEdit/CommitEdit 
   block, Splits are subordinate to Transactions.  There is no public 
   BeginEdit/CommitEdit block for Splits; changes to Splits should be wrapped
   in their Transaction's Edit-block.

   In the case of the Split <-> Account relationship, the call to
   xaccSplitSetAccount() will be immediately visible from
   xaccSplitGetAccount(), but the Account does not learn about the
   Split until and if the edit is committed.

   In the case of the Split <-> Transaction relationship, calling
   xaccSplitSetParent() will immediately add the Split to the
   Transactions split list.  This is because the Split's Transaction
   owns the reference to the Split.  However, see the Transaction.c 
   patch for how to distinguish pre-edit state from in-edit state.

   In both cases, events are not generated until the edits are committed.
   Most of this new logic is in an engine-private helper xaccSplitCommitEdit(),
   which is called from xaccTransCommitEdit().

   Incidental:
      Increased error-checking in xaccSplitSetValue().
      Internalize a Transaction Begin/Commit edit-block in every setter func.


r13456 | chris | 2006-03-03 19:08:16 -0500 (Fri, 03 Mar 2006) | 7 lines

   M /gnucash/trunk/src/engine/engine-utilities.scm
   M /gnucash/trunk/src/engine/engine.scm
   M /gnucash/trunk/src/engine/gw-engine-spec.scm
   M /gnucash/trunk/src/report/report-system/report-utilities.scm

   Remove two slightly different definitions of
   gnc:transaction-map-splits, both unused.
   Remove g-wrapped versions of functions being removed:
      gnc:account-fix-split-date-order,
      gnc:trans-fix-split-date-order

2006-03-03  David Hampton  <hampton@employees.org>

	* numerous: Convert the account separator from a single character
	to a character string.  This allows multibyte unicode characters
	to be the account separator character. Fixes 333061.  Reworked a
	couple of routines that pull account names into their component
	parts.  Also fixed a bug in the new account dialog when creating
	multiple accounts at once.

2006-03-03  Derek Atkins  <derek@ihtfp.com>

	* configure.in: error out on g-wrap-1.3, gcc4, and error-on-warning.
	  Fixes #330615.

2006-03-02  Joshua Sled  <jsled@asynchronous.org>

	* src/gnc-ui.h: Fix SXEDITOR help target id.  Bug#128857.

2006-03-02  Christian Stimming  <stimming@tuhh.de>

	* src/import-export/mt940/gnc-mt940-import.c: More work on mt940
	import. Completed #325170.

	* accounts/el_GR/*-xea: Greek account templates converted to
	UTF-8, by Nikos Charonitakis <nikosx@gmail.com>.

2006-03-02  David Hampton  <hampton@employees.org>

	* numerous: Move the storage for the account separator character
	into Account.c (default ':') and set it with an accessor function
	at startup and when it is changed in the preferences/gconf.
	Eliminate unnecessary passing around of the account separator
	character.

2006-03-01  David Hampton  <hampton@employees.org>

	* src/register/register-core/pricecell.c:
	* src/register/register-core/formulacell.c:
	* src/calculation/fin_spl_protos.h:
	* src/calculation/expression_parser.c:
	* src/app-utils/gnc-ui-util.[ch]:
	* src/app-utils/gnc-exp-parser.c: Convert all locations that parse
	input using the locale thousands/decimal point characters to use
	unicode functions.  This should allow multi-byte unicode
	characters to work as these separators on input.

	* src/app-utils/gnc-ui-util.c: Rework of Sylvain Defresne's patch
	to support multi-byte unicode thousands separator and decimal
	point characters when printing numbers.

2006-03-01  Derek Atkins  <derek@ihtfp.com>

	* src/report/standard-reports/transaction.scm:
	  Andrew Sackville-West's patch to add transaction links.

2006-02-28  David Hampton  <hampton@employees.org>

	* src/gnome-utils/dialog-account.c: Collapse the common parts of
	the "new account" and "edit account" dialog validation code into a
	single routine.  Fixes 117812.

	* src/app-utils/options.scm: Andreas Köhler's patch to correctly
	build a html color value. Fixes 328933.

2006-02-28  Joshua Sled  <jsled@asynchronous.org>

	* src/bin/gnucash-bin.c (gnucash_command_line): Terminate
	GOptionEntry array, preventing warnings and/or errors parsing
	command-line options.

2006-02-28  David Hampton  <hampton@employees.org>

	* configure.in: Set the GNOME_DISABLE_DEPRECATED flag for gnome
	versions up to 2.13.7.

	* src/gnome-utils/dialog-options.c: Allow this one file to use
	deprecated gnome functions, but only when compiled with gtk 2.4.
	Later versions of gtk include the needed replacement function and
	deprecated gnome functions are not allowed.

r13426 | chris | 2006-02-28 14:57:24 -0500 (Tue, 28 Feb 2006) | 3 lines

   M /gnucash/trunk/src/register/ledger-core/split-register-control.c
   M /gnucash/trunk/src/register/ledger-core/split-register-model-save.c
   M /gnucash/trunk/src/register/ledger-core/split-register-model.c
   M /gnucash/trunk/src/register/ledger-core/split-register-p.h

   Make register use engine-provided xaccTransGetAccountConvRate() instead of
   writing its own.

r13425 | chris | 2006-02-28 14:46:19 -0500 (Tue, 28 Feb 2006) | 3 lines

   M /gnucash/trunk/src/register/ledger-core/split-register-model.c

   Make register use engine-provided xaccTransGetAccountBalance() instead
   of writing its own.

r13424 | chris | 2006-02-28 14:38:29 -0500 (Tue, 28 Feb 2006) | 3 lines

   M /gnucash/trunk/src/register/ledger-core/split-register-model.c

   Make register use engine-provided xaccTransGetAccountAmount() instead of 
   writing its own.

r13423 | chris | 2006-02-28 14:34:42 -0500 (Tue, 28 Feb 2006) | 3 lines

   M /gnucash/trunk/src/register/ledger-core/split-register-control.c

   Make register use engine-provided xaccTransHasReconciledSplits() instead 
   of writing it's own.

2006-02-27  David Hampton  <hampton@employees.org>

	* src/gnome-utils/dialog-utils.[ch]: Remove a unused function that
	calls deprecated gnome routines.

	* src/gnome/window-reconcile.c:
	* src/gnome/ui/gnc-reconcile-window-ui.xml:
	* src/gnome/ui/Makefile.am: Convert the reconcile window from the
	old GnomeUIInfo menu/toolbar widgets to the newer GtkAction based
	widgets.

2006-02-27  Joshua Sled  <jsled@asynchronous.org>

	* src/backend/file/gnc-backend-file.h (struct FileBackend_struct):
	Remove unused `pricedb_lookup` and `export` operations from
	gnucash-specific file backend.

	* src/backend/file/gnc-backend-file.c (gnc_backend_new): Use
	correct 'export' function-slot, allowing File > Export > Export
	Accounts to work again.  Bug#332802.

	* src/gnome/gnc-plugin-basic-commands.c: Clarify "Export Accounts"
	from "Export Chart of Accounts [to QSF].

	* src/calculation/expression_parser.c (primary_exp): Fix infinite
	loop in parsing malformed functions (e.g. "ipmt(1:2:)"). Bug#332804.

	* src/app-utils/gnc-exp-parser.c (func_op): No longer crashes on
	an invalid formula, though it's also not very clear what's going
	on.  Basically fixes Bug#137885.

2006-02-27  David Hampton  <hampton@employees.org>

	* src/engine/gnc-pricedb.[ch]:
	* src/engine/gnc-pricedb-p.h:
	* src/engine/Account.[ch]:
	* src/app-utils/gnc-ui-util.[ch]: Add 'const' qualifiers to
	various functions.

	* src/gnome-utils/gnc-main-window.c: Check for the existence of a
	page before dereferencing it. Fixes 332680.

2006-02-27  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-gnome/glade/job.glade
	* src/business/business-gnome/glade/order.glade
	* src/business/business-gnome/glade/invoice.glade
	* src/business/business-gnome/glade/billterms.glade
	* src/business/business-gnome/glade/payment.glade
	* src/business/business-gnome/glade/vendor.glade
	* src/business/business-gnome/glade/customer.glade
	  Don't need to translate placeholder labels.

2006-02-26  Derek Atkins  <derek@ihtfp.com>

	Apply a re-work of Titi Ala'ilima's patch to apply payments
	directly to invoices.  This fixes bug #121420.
	* src/business/business-core/gncInvoice.[ch]:
	  Add argument to the ProcessPayment API to allow the caller
	  to specify an invoice to post to first.
	* src/business/business-gnome/business-gnome-utils.[ch]:
	  Create an invoice-select API that lets you select an invoice
	  based on an owner (or not).  I.e., you can limit the invoice
	  search based on a selected owner.  If you change the owner
	  it invalidates the invoice search.
	* src/business/business-gnome/dialog-payment.[ch]:
	  Change the API from ..new_with_value() to ..new_with_invoice().
	  Pull the default amount from the invoice (if one exists).
	  Allow the user to select an invoice and apply payments there.
	  If the user changes the owner, invalidate the invoice.
	* src/business/business-gnome/business-options-gnome.c:
	  use the new invoice-select API instead of calling general_search
	  API directly.
	* src/business/business-gnome/dialog-invoice.c:
	  call the new dialog-payment API.  No need to compute the initial
	  value here; the payment dialog will compute it from the invoice
	  (instead of computing it from the invoice here).
	* src/business/business-gnome/glade/payment.glade:
	  Add invoice-selector label and box.

2006-02-26  David Hampton  <hampton@employees.org>

	* packaging: Create a consolidated directory for distribution
	specific scripts.

	* src/gnome-utils/dialog-utils.[ch]:
	* src/app-utils/option-util.c: Restore GtkOptionMenu support
	because the newer GtkComboBox doesn't support per item tooltips.
	Fixes bug 332569.

2006-02-26  Neil Williams <linux@codehelp.co.uk>

	* qof/qof-be-utils.h : Replace macro to restore
	programme flow.
	* qof/qofevent.c : 
	* qof/qofevent.h : Outline method to make application 
	events easier to use.

	* qof/deprecated.c : Define deprecated event functions
	that call new QofEvents with a NULL event_data argument.
	* qof/qofbook.c : Use new qof_event arguments.
	* qof/qofevent.c : Allow events to be generated with an
	optional event_data argument.
	* qof/qofevent.h : Doxygen tweaks.

2006-02-26  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome-utils/gnc-html-graph-gog.c:
	Andreas Köhler's patch for barchart improvements: segment color
	setting, axis rotation and formatting.

	* src/engine/SX-book.c (gnc_sx_get_sxes_referencing_account): 
	* src/gnome/dialog-scheduledxaction.c: Add handler for
	account-deleted events, determine and display editors for SXes
	referencing those accounts.  Fixes Bug#312730.

	* src/report/utility-reports/Makefile.am (SCM_FILE_LINKS):
	* src/report/utility-reports/utility-reports.scm: 
	* src/report/utility-reports/iframe-url.scm:
	* doc/tip_of_the_day.list.in: 
	Remove web browser "report".

r13395 | chris | 2006-02-26 13:36:05 -0500 (Sun, 26 Feb 2006) | 2 lines

   M /gnucash/trunk/src/business/business-core/gncBillTerm.c
   M /gnucash/trunk/src/business/business-core/gncCustomer.c
   M /gnucash/trunk/src/business/business-core/gncEmployee.c
   M /gnucash/trunk/src/business/business-core/gncEntry.c
   M /gnucash/trunk/src/business/business-core/gncInvoice.c
   M /gnucash/trunk/src/business/business-core/gncJob.c
   M /gnucash/trunk/src/business/business-core/gncOrder.c
   M /gnucash/trunk/src/business/business-core/gncTaxTable.c
   M /gnucash/trunk/src/business/business-core/gncVendor.c
   M /gnucash/trunk/src/engine/Account.c
   M /gnucash/trunk/src/engine/gnc-pricedb.c

   Use function version of QOF_COMMIT_EDIT_PART2.

r13391 | chris | 2006-02-26 00:00:52 -0500 (Sun, 26 Feb 2006) | 2 lines

   M /gnucash/trunk/lib/libqof/qof/guid.c

   Keep track of exactly how many bytes we've sent to md5_process_bytes().

r13390 | chris | 2006-02-25 23:56:47 -0500 (Sat, 25 Feb 2006) | 8 lines

   M /gnucash/trunk/lib/libqof/qof/qof-be-utils.h
   M /gnucash/trunk/lib/libqof/qof/qofbackend.c

   Implement QOF_COMMIT_EDIT_PART2 as a function instead of a macro.
   Any of the callbacks passed to this function may be NULL to decline the 
   use of that callback.  Also, the three callbacks are now called in three
   mutually exclusive cases, corresponding to: 
      1) a failed commit, ('on_error')
      2) a successful commit where the object remains valid, ('on_done'), and 
      3) a successful commit where the object has been destroyed, ('on_free').

2006-02-25  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-main-window.c: Remember the order in which
	the notebook tabs are referenced. When closing a tab, switch to
	the tab that was previously in front, not the first tab in the
	notebook. Fixes 332355.

2006-02-24  David Hampton  <hampton@employees.org>

	* src/register/register-gnome/gnucash-sheet.[ch]:
	* src/register/register-gnome/gnucash-item-edit.[ch]:
	* src/gnome/gnc-plugin-page-register.c: Override the generic edit
	menu sensitivity code to provide the right sensitivity for the
	entry widget buried in the register.

	* src/gnome-utils/gnc-main-window.c:
	* src/gnome-utils/gnc-plugin-page.h: Provide a hook for pages to
	override the generic edit menu sensitivity code.

	* src/gnome-utils/ui/gnc-main-window-ui.xml:
	* src/gnome-utils/gnc-main-window.c: Remove unnecessary menu
	item. The same functionality exists in the "Menus & Toolbars"
	preference panel.

2006-02-24  Christian Stimming  <stimming@tuhh.de>

	* src/import-export/import-account-matcher.h: Let the account
	matcher accept a parent widget to avoid windows that are lost
	behind other windows. Adapt importer modules accordingly.

	* src/import-export/import-account-matcher.c: Don't allow
	placeholder be selected for importing transactions. Fixes
	bug#327891.

	* src/import-export/mt940/gnc-mt940-import.c: Get MT940 importer
	compile again (experimental; requires aqbanking-1.9.7). It is not
	yet tested with actual files. Bug#325170.

	* src/import-export/import-account-matcher.h: Make gchar argument
	const because it is only used as a const.

r13378 | chris | 2006-02-24 00:53:35 -0500 (Fri, 24 Feb 2006) | 7 lines

   M /gnucash/trunk/src/business/business-gnome/dialog-invoice.c
   M /gnucash/trunk/src/engine/gnc-session.c
   M /gnucash/trunk/src/engine/gnc-session.h
   M /gnucash/trunk/src/gnome-utils/gnc-file.c

   Since QOF no longer keeps track of the "current" session, 
   qof_session_destroy() no longer clears the current session when we destroy
   it.  Therefore, explicitly call gnc_clear_current_session() when we want
   to destroy the current session.
   Also, avoid accidentally creating a new book and session if there is no
   open book/current session when we run the bill reminder.

r13369 | chris | 2006-02-23 15:11:02 -0500 (Thu, 23 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome/dialog-sxsincelast.c
   M /gnucash/trunk/src/import-export/ofx/gnc-ofx-import.c

   When we malloc a Transaction, then TransBeginEdit, then want to abort,
   just call xaccTransDestroy(), xaccTransCommitEdit().  No rollback needed.

r13368 | chris | 2006-02-23 12:44:42 -0500 (Thu, 23 Feb 2006) | 5 lines

   M /gnucash/trunk/src/engine/Split.c
   M /gnucash/trunk/src/engine/Split.h
   M /gnucash/trunk/src/engine/SplitP.h

   Dirty Splits when they change.
   Add const to Split where appropriate.
   Fix GCache crash cause by using non-cached value in cached 'action' field 
   from the qsf-backend.

2006-02-23  David Hampton  <hampton@employees.org>

	* src/report/report-system/html-utilities.scm: Andrew
	Sackville-West's to pass the rignt number of arguments to
	gnc:register-guid.

	* src/report/report-gnome/gnc-plugin-page-report.c:
	* src/gnome-utils/gnc-recurrence.c:
	* src/gnome-utils/gnc-plugin-file-history.c:
	* src/gnome-utils/gnc-main-window.c:
	* src/gnome-utils/gnc-plugin-page.[ch]:
	* src/gnome-utils/dialog-commodity.c:
	* src/gnome/gnc-plugin-page-register.c: Minor code cleanup and
	consolidations.

2006-02-23  Joshua Sled  <jsled@asynchronous.org>

	* gentoo/gnucash-1.9.x.ebuild: Add ebuild for gnucash 1.9/2.0 series.

	* src/gnome-utils/dialog-totd.c (gnc_totd_dialog): Increment TOTD
	index on dialog init.

	* src/gnome-utils/gnc-html-graph-gog.c (handle_barchart): fix
	x-axis labeling.  Patch from Andreas Köhler.  Bug#332359.

2006-02-23  Derek Atkins  <derek@ihtfp.com>

	* src/import-export/qif-import/test/Makefile.am:
	  add QOF_LIBS to link line because debian libtool is broken.
	
2006-02-22  Derek Atkins  <derek@ihtfp.com>

	* src/gnome/gnc-plugin-page-register.c:
	  include gtk-compat.h so we build against gtk-2.4.

	* src/gnome-utils/Makefile.am:
	  force a build from svn to have access to svn version info.
	  this might break the broken ebuild that forcibly removes the
	  .svn directories, but the ebuild is broken and shouldn't do that.

2006-02-22  David Hampton  <hampton@employees.org>

	* src/gtk-compat.h:
	* src/gnome/gnc-plugin-page-register.c: Cleanup patch from Andreas
	Köhler.

	* src/register/ledger-core/split-register.[ch]:
	* src/register/ledger-core/split-register-control.c:
	* src/gnome/gnc-plugin-page-register.c: Provide a callback whereby
	the core register code can tell the upper layers that it has moved
	from an expanded transaction to a collapsed transaction.  This
	lets the upper layer adjust the "split" transaction toolbar button
	properly.  Fixes 332165.

r13363 | chris | 2006-02-22 16:52:46 -0500 (Wed, 22 Feb 2006) | 3 lines

   M /gnucash/trunk/src/engine/Makefile.am
   A /gnucash/trunk/src/engine/Split.c (from /gnucash/trunk/src/engine/Transaction.c:13362)
   A /gnucash/trunk/src/engine/Split.h (from /gnucash/trunk/src/engine/Transaction.h:13359)
   A /gnucash/trunk/src/engine/SplitP.h (from /gnucash/trunk/src/engine/TransactionP.h:13359)
   M /gnucash/trunk/src/engine/Transaction.c
   M /gnucash/trunk/src/engine/Transaction.h
   M /gnucash/trunk/src/engine/TransactionP.h

   Separate the Split functions from Transaction.c into Split.c.
   Introduce xaccSplitVoid() and xaccSplitUnvoid() to aid the separation.

r13362 | chris | 2006-02-22 12:41:58 -0500 (Wed, 22 Feb 2006) | 3 lines

   M /gnucash/trunk/src/engine/Transaction.c

   Add some comments, error checks, ENTER/LEAVE balances and a special-case
   early-return for the conversion-rate calculation.

r13360 | chris | 2006-02-22 09:22:30 -0500 (Wed, 22 Feb 2006) | 3 lines

   M /gnucash/trunk/src/engine/gnc-lot.c

   Use correct function name qof_instance_set_dirty.
   Comment on current state of Lot behavior.

r13359 | chris | 2006-02-22 01:01:07 -0500 (Wed, 22 Feb 2006) | 3 lines

   M /gnucash/trunk/src/engine/Period.c
   M /gnucash/trunk/src/engine/Transaction.c
   M /gnucash/trunk/src/engine/gnc-lot-p.h
   M /gnucash/trunk/src/engine/gnc-lot.c

   Convert Lots from a QofEntity to a QofInstance.
   They now store their own dirty state.

r13358 | chris | 2006-02-21 22:30:48 -0500 (Tue, 21 Feb 2006) | 4 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/gnome-utils/gnc-file.c

   No need to run the BOOK_OPENED hook twice when open a book.
   And no need to run it at all when we fail to open a book.
   Also, require HAVE_GTK26 before using gtk_get_option_group().

r13357 | chris | 2006-02-21 22:05:20 -0500 (Tue, 21 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome-utils/gnc-file.c
   M /gnucash/trunk/src/gnome-utils/gnc-main-window.c

   Avoid instantiating the current session until we're actually opening a file.

r13356 | chris | 2006-02-21 21:43:20 -0500 (Tue, 21 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome/dialog-chart-export.c
   M /gnucash/trunk/src/gnome/druid-acct-period.c
   M /gnucash/trunk/src/gnome/gnc-plugin-basic-commands.c
   M /gnucash/trunk/src/gnome/gnc-plugin-page-budget.c
   M /gnucash/trunk/src/gnome/gnc-plugin-page-register.c

   Files accidentally left out of previous commit (r13355).

r13355 | chris | 2006-02-21 21:39:02 -0500 (Tue, 21 Feb 2006) | 5 lines

   M /gnucash/trunk/src/app-utils/gnc-ui-util.c
   M /gnucash/trunk/src/app-utils/gw-app-utils-spec.scm
   M /gnucash/trunk/src/business/business-gnome/dialog-invoice.c
   M /gnucash/trunk/src/business/business-gnome/gnc-plugin-business.c
   M /gnucash/trunk/src/engine/Makefile.am
   A /gnucash/trunk/src/engine/gnc-session.c
   M /gnucash/trunk/src/engine/gnc-session.h
   M /gnucash/trunk/src/gnome-utils/gnc-file.c
   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.c
   M /gnucash/trunk/src/gnome-utils/gnc-main-window.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.c

   Remove uses of deprecated qof_session_get_current_session() and 
   qof_session_set_current_session().  GnuCash now manages its own current
   session.  New function: gnc_current_session_exist() to test whether there
   is a current session.

r13351 | chris | 2006-02-21 16:46:07 -0500 (Tue, 21 Feb 2006) | 2 lines

   M /gnucash/trunk/lib/libqof/qof/qofid.c

   Mark the QofCollection as dirty when a new QofEntity is added or removed.

r13350 | chris | 2006-02-21 16:44:42 -0500 (Tue, 21 Feb 2006) | 3 lines

   M /gnucash/trunk/src/engine/gnc-lot.c

   Mark the GNC_LOT QofCollection dirty whenever a Lot changes.
   This includes when the KVP is changed via the setters. 

r13347 | chris | 2006-02-21 15:27:40 -0500 (Tue, 21 Feb 2006) | 2 lines

   M /gnucash/trunk/src/engine/Account.c

   Avoid qof-dirtying Accounts when Splits or Lots are inserted or removed.

r13345 | chris | 2006-02-21 14:43:00 -0500 (Tue, 21 Feb 2006) | 4 lines

   M /gnucash/trunk/src/engine/test-core/test-engine-stuff.c

   Move the code that (usually) ensures value/amount consistency for Splits
   from add_random_splits() to get_random_split().
   Avoid numeric overflow when creating split values.

2006-02-21  David Hampton  <hampton@employees.org>

	* src/gnome/gnc-plugin-page-register.c: Fix from Andreas Köhler to
	deactivate the toolbar split button in an auto-split register.
	Fixes 330621.

	* src/gnome-utils/gnc-tree-model-account.c: Two fixes from Andreas
	Köhler.  One fixes 331183, the problem where editing a top-level
	account doesn't set the current parent.

2006-02-21  Joshua Sled  <jsled@asynchronous.org>

	* lib/libqof/qof/qofevent.[ch] (QOF_DEFAULT_EVENT_LIMIT): rename, set
	to reasonable value (the last-defined event).

	* src/register/ledger-core/split-register-load.c
	(gnc_split_register_load): Ensure that a (unique) relevent split
	from the currently-pending transaction is always in the split list
	before we load it, preventing transactions from disappearing from
	a register while being edited, but without saving the entire (and
	maybe partially-invalid) split list around for a while. Fixes bugs
	108347, 125480, 141287, 153183, 168630 (and maybe 126471).
	
	* src/register/ledger-core/split-register.c (gnc_split_register_destroy_info):
	* src/register/ledger-core/split-register-p.h (struct sr_info):
	Remove saved_slist.

	* lib/libqof/qof/qofevent.h (QOF_EVENT_CREATE):
	Fix event values.

2006-02-20  David Hampton  <hampton@employees.org>

	* src/register/register-gnome/gnucash-date-picker.c: Andreas
	Köhler's patch to prevent a crash in the register date picker
	widget when using gtk 2.8.

	* src/bin/gnucash-bin.c:
	* src/gnome-utils/glade/commodity.glade:
	* src/gnome-utils/dialog-commodity.c:
	* src/gnome/dialog-price-edit-db.c: Disable quote related
	functionality when F::Q isn't installed.  Fixes 130347 and 314054.

	* src/gnome-utils/gnc-file.[ch]:
	* src/gnome-utils/gnc-main-window.c: Catch and defer the quit
	command if a file save is in progress. Fixes 155327.

	* rpm/gnucash.spec.in:
	* rpm/README: Update spec file from RH8 to FC4.

	* src/backend/file/sixtp-utils.c:
	* src/backend/postgres/test/test-db.c:
	* src/report/report-gnome/gnc-plugin-page-report.c:
	* src/calculation/fin.c:
	* src/gnome-utils/gnc-html.c:
	* src/gnome-utils/gnc-html-graph-gog.c:
	* lib/libgsf-1.12.3/gsf/gsf-output-stdio.c:
	* lib/libgsf-1.12.3/gsf/gsf-utils.c:
	* configure.in: Compile cleanly with when _FORTIFY_SOURCE is
	defined.  This definition is forced when building RPMs on FC4.

2006-02-20  Derek Atkins  <derek@ihtfp.com>

	* configure.in: fix the qof configure test for OSX.

2006-02-20  David Hampton  <hampton@employees.org>

	* lib/libqof/qof/guid.c: Don't reference uninitialized memory.

2006-02-20  Neil Williams  <linux@codehelp.co.uk>

	* lib/libqof/qof/gnc-event.c :
	* lib/libqof/qof/gnc-event-p.h :
	* lib/libqof/qof/gnc-event.h : Removed files.

	* lib/libqof/qof/qofevent.c :
	* lib/libqof/qof/qofevent-p.h :
	* lib/libqof/qof/qofevent.h : Replacement files using extensible
	event identifiers.

	* lib/libqof/qof/deprecated.c : Old functions now pointed to
	replacements.
	* lib/libqof/qof/deprecated.h : Old defines now pointed to
	replacements.

	* lib/libqof/qof/qof.h : Replace files.
	* lib/libqof/qof/Makefile.am : Replace files.
	
2006-02-20  David Hampton  <hampton@employees.org>

	* src/gnome/dialog-scheduledxaction.c:
	* src/gnome/glade/sched-xact.glade: Use a spin_box instead of an
	entry for the 'occurrences' and 'remaining' numeric fields.

	* src/gnome/dialog-scheduledxaction.[ch]:
	* src/gnome/glade/sched-xact.glade: HIGify the scheduled
	transaction dialogs.

	* src/gnome/gnc-plugin-page-register.c: Remove forced screen
	updates that are no longer necessary.

	* src/register/register-gnome/gnucash-sheet.c: If the number of
	"visible to the user" lines in the register has shrunk, force the
	parent widget to redraw.  This fixes #328787.

r13338 | chris | 2006-02-20 20:24:03 -0500 (Mon, 20 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome-utils/gtktreedatalist.c

   Use glib's slice allocator in favor of GMemChunks for glib >= 2.9.
   Patch by Andreas Köhler <andi5.py@gmx.net>.

r13330 | chris | 2006-02-20 15:47:01 -0500 (Mon, 20 Feb 2006) | 6 lines

   M /gnucash/trunk/src/gnome-utils/Makefile.am
   A /gnucash/trunk/src/gnome-utils/gnctreemodelsort.c
   A /gnucash/trunk/src/gnome-utils/gnctreemodelsort.h
   A /gnucash/trunk/src/gnome-utils/gtktreedatalist.c
   A /gnucash/trunk/src/gnome-utils/gtktreedatalist.h

   Add a local copy of GtkTreeModelSort from gtk 2.8.12.  Our local copy is 
   called GncTreeModelSort.  This newer version of GtkTreeModelSort fixes at 
   least one observed bug with our use of sorted models.  The 
   gtktreedatalist.[ch] files are used by GtkTreeModelSort and are directly 
   from gtk 2.8.12 without any renames because they aren't exported by gtk.

r13329 | chris | 2006-02-20 15:22:24 -0500 (Mon, 20 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome-utils/dialog-options.c
   M /gnucash/trunk/src/gnome-utils/dialog-utils.c
   M /gnucash/trunk/src/gnome-utils/dialog-utils.h
   M /gnucash/trunk/src/gnome-utils/gnc-main-window.c

   Explictly require gtk2.6 for conditionally compiled code that needs it.

r13328 | chris | 2006-02-20 15:09:02 -0500 (Mon, 20 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gtk-compat.h
   M /gnucash/trunk/src/import-export/hbci/dialog-hbcitrans.c
   M /gnucash/trunk/src/register/register-gnome/gnucash-item-list.c

   Factor out a compat definition of GTK_TREE_SORTABLE_UNSORTED_SORT_COLUMN_ID
   into gtk-compat.h.

r13313 | chris | 2006-02-19 21:58:29 -0500 (Sun, 19 Feb 2006) | 1 line

   M /gnucash/trunk/src/engine/test-core/test-engine-stuff.c

   Fix for 'use of uninitialized' warning.

2006-02-19  Derek Atkins  <derek@ihtfp.com>

	* src/engine/Transaction.c:
	  Allow nested begin/commit in xaccTransSetTxnType().  Fixes #331771.
	  The old code wouldn't let you set the value if you were already
	  within a BeginEdit/CommitEdit block.

2006-02-19  Chris Lyttle  <chris@wilddev.net>

	* NEWS: Added some text about the release.
	* configure.in: Change to version 1.9.1

2006-02-19  David Hampton  <hampton@employees.org>

	* src/register/register-gnome/pricecell-gnome.c: Take the
	selection into account when handling the keypad decimal point key.
	Fixes 314775.

	* src/register/register-gnome/combocell-gnome.c: When looking for
	an matching account name, start at the beginning of the selected
	region, not the end.  Problem created when the code stopped adding
	placeholder accounts to the quickfill.  Fixes 328893.

2006-02-19  Neil Williams  <linux@codehelp.co.uk>

	* backend/file/qsf-backend.c : Correcting collect handling,
	prevent duplication.
	* qof/qof.h : Create reference group in doxygen and
	export qofreference.h into the API.
	* qof/qof/qofsession.c : Set QOF_TYPE_COLLECT as registered
	type and move qof_entity_get_reference_from to new file.
	* qof/qof/qofsession.h : Move qof_entity_get_reference_from
	to new file: qofreference.c|h.
	* qof/qofreference.c : New file to handle reference related
	code.
	* qof/qofreference.h : New public header.
	* qof/test/test-recursive.c : Fix collect recursive tests

2006-02-19  David Hampton  <hampton@employees.org>

	* src/quotes/finance-quote-helper.in:
	* src/quotes/dump-finance-quote:
	* src/quotes/update-finance-quote.in:
	* src/quotes/Makefile.am:
	* src/quotes/value_portfolio:
	* src/quotes/gnc-prices:
	* src/quotes/README:
	* src/quotes/finance-quote-check.in:
	* src/core-utils/gw-core-utils-spec.scm:
	* src/scm/price-quotes.scm: Regularize the naming of the
	Finance::Quote auxiliary scripts. Remove the obsolete gnc-prices
	script.  Move the to the bin directory the scripts that weren't
	already there.

2006-02-19  Joshua Sled  <jsled@asynchronous.org>

	* src/app-utils/gnc-account-merge.[ch]: Remove placeholder-difference
	"ERROR" merge state.

	* src/gnome/druid-hierarchy.c (placeholder_cell_data_func)
	(on_final_account_prepare): Remove use of default
	account-tree-model placeholder column, and substitute a column
	that reflects the post-merge value.

2006-02-19  Derek Atkins  <derek@ihtfp.com>

	* src/engine/TransLog.c:  use TABS not SPACES for column separators
	* src/import-export/log-replay/gnc-log-replay.c: use printf
	  so we don't have a tab->space conversion problem like we
	  did in TransLog.c
	  Fixes #331620.

	* src/business/business-gnome/dialog-payment.c:
	  Pop up a warning dialog if the user has no valid post-to accounts.
	  Fixes #331730.

	* src/business/business-reports/fancy-invoice.scm:
	  Brian's patch to add company-id to the company address.

	* src/business/business-core/gncOwner.[ch]: Add api to get owner
	  kvp-slots abstractly.
	* src/business/business-gnome/dialog-payment.c: Load/save the
	  last-used transfer account whenever the owner changes or
	  the dialog completes.
	  Fixes #329725.

	* lib/goffice-0.0.4/goffice/cut-and-paste/foo-canvas/foo-canvas-i18n.h:
	  Use glib's gi18n.h instead of redefining gettext.

	* src/engine/test/test-engine-stuff.c:
	  - Prefer QUERY_AND and QUERY_OR over NAND, NOR, XOR
	  - Don't randomly generate a gnc_numeric with a 0 denominator.

	* src/business/business-gnome/dialog-invoice.c:
	  Don't let users post negative invoices.  (#166864)
	  Pop up an error dialog and prevent the post.

	* lib/libqof/qof/guid.[ch]:
	  Phil Longstaff's patch to make the GUID length a magic number.

2006-02-18  Derek Atkins  <derek@ihtfp.com>

	* intl-scm/xgettext.scm: remove the absolute path from filenames
	* intl-scm/Makefile.am: pass the absolute path to xgettext.scm

	* src/import-export/log-replay/gnc-log-replay.c:
	  display an error dialog when we fail to parse a log file
	  due to EOF or a bad header parsing.  Fixes #331620 based
	  on the test-case.

2006-02-17  David Hampton  <hampton@employees.org>

	* src/register/register-gnome/gnucash-sheet.c:
	* src/register/register-gnome/gnucash-item-edit.[ch]: Remove all
	explicit claiming of the selection in these files.  The GtkEntry
	they use already performs claims, and the additional just mess
	things up.  Fixes #330153.

	* src/register/register-gnome/gnucash-item-list.c:
	* src/report/report-gnome/dialog-style-sheet.c:
	* src/gnome-utils/gnc-tree-model-commodity.c:
	* src/gnome-utils/gnc-tree-model-budget.[ch]:
	* src/gnome-utils/gnc-tree-model-account.c:
	* src/gnome-utils/gnc-tree-model-price.c:
	* src/gnome-utils/gnc-tree-view-account.c:
	* src/gnome-utils/dialog-options.c:
	* lib/goffice-0.0.4/goffice/graph/gog-guru.c:
	* lib/goffice-0.0.4/goffice/gtk/go-format-sel.c: Prepare for gtk
	change that will issue warnings if the return value of the
	gtk_tree_model iter functions are not used.

2006-02-17  Derek Atkins <derek@ihtfp.com>

        * intl-scm/Makefile.am:
        * lib/guile-www/Makefile.am:
        * src/app-utils/Makefile.am:
	* src/business/business-core/Makefile.am:
        * src/business/business-gnome/Makefile.am:
        * src/business/business-reports/Makefile.am:
        * src/business/business-utils/Makefile.am:
        * src/business/dialog-tax-table/Makefile.am:
	* src/core-utils/Makefile.am:
        * src/engine/Makefile.am:
	* src/gnc-module/Makefile.am:
	* src/gnome/Makefile.am:
        * src/gnome-utils/Makefile.am:
	* src/import-export/hbci/Makefile.am:
        * src/import-export/Makefile.am:
        * src/import-export/qif-import/Makefile.am:
        * src/import-export/qif-io-core/Makefile.am:
	* src/register/register-core/Makefile.am:
	* src/report/locale-specific/us/Makefile.am:
        * src/report/report-gnome/Makefile.am:
        * src/report/report-system/Makefile.am:
        * src/report/standard-reports/Makefile.am:
        * src/report/stylesheets/Makefile.am:
        * src/report/utility-reports/Makefile.am:
        * src/scm/gnumeric/Makefile.am:
        * src/scm/Makefile.am:
        * src/scm/printing/Makefile.am:
        * src/tax/us/Makefile.am:
          Make the build work if the build directory is not the source
          directory.  Also symlink .scm files into the build directory
          so it's possible to run from it.
	  Also fix "fin.scm installed twice", bug #168629.

	* src/import-export/log-replay/gnc-log-replay.c:
	  Don't pass NULL to ferror() (from bug #143720).

	* src/import-export/log-replay/gnc-log-replay.c:
	  scrub the transaction for a currency after we replay. (#143720).

	* configure.in: remove un-needed/wanted gsf/goffice configure options
	* macros/g-wrap.m4: fix the help text spacing.

	* configure.in: autodetect OFX and use it if we find it.
	  the --enable/disable-ofx will make the check fatal on failure
	  or skip it altogether if you want to ignore an existing libofx.

r13280 | chris | 2006-02-17 10:03:23 -0500 (Fri, 17 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome-utils/dialog-account.c

   Use GPOINTER_TO_INT to avoid casting pointer to integer of different size.

2006-02-15  Derek Atkins <derek@ihtfp.com>

	* configure.in:  get --disable-gui to actually do what we want.
	  - Move a bunch of configure code around in the file.
	  - Don't look for goffice/gsf if we ask for --disable-gui
	  - add a few more comments
	  - no need to check for libxml2 twice  (more work to do here).

	* src/backend/file/test/Makefile.am:
	* src/backend/file/Makefile.am:
	* src/business/business-core/file/Makefile.am:
	* src/gnome-utils/Makefile.am:
	* lib/libgsf-1.12.3/tests/Makefile.am:
	* configure.in:
	  combine XML_{CFLAGS,LIBS} into LIBXML2_{CLFLAGS,LIBS}

	* src/backend/file/test/test-load-xml2.c:
	* src/backend/file/gncmod-file-backend.c:
	  move jsled's g-type initialization into the module init
	  this way we don't need to worry about it in every test app.

	* src/backend/file/test/test-load/xml2.c:
	  need g_type_init() because we don't actually "load" the file backend.

	* lib/libqof/qof/Makefile.am: add qofla-dir.h to DISTCLEANFILES

2006-02-15  Joshua Sled  <jsled@asynchronous.org>

	* src/backend/file/test/test-load-xml2.c (main): Initialize
	g_types before we can expect gconf (via the gnc file backend) to
	work, as per the gconf API docs.

	* src/gnome/dialog-hierarchy.c:
	* src/gnome/glade/account.glade: Andreas Köhler's patch to not
	scroll the tree view headers in the new-account hierarchy druid.
	Bug#330850.

2006-02-15  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-core/business-core.scm: 
	  Fix a typo; forgot one procedure name-change instance.

	* lib/libqof/qof/Makefile.am: keep qofla-dir.h out of the dist
	* configure.in: look in builddir for qof includes.

	* src/business/business-reports/owner-report.scm:
	  set the document title properly.

r13271 | chris | 2006-02-15 17:06:37 -0500 (Wed, 15 Feb 2006) | 11 lines

   M /gnucash/trunk/src/gnome-utils/dialog-account.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-account-types.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-account-types.h

   Convert the AccountType selection functions to work with GtkTreeSelections
     from views using the filtered GncTreeModelAccountTypes.
   Privatize the unfiltered GncTreeModelAccountTypes - now, every accessible
     account-types TreeModel is a new GtkTreeModelFilter, and their 
     ref-counting is always the same.
   Add some tweaks to gnc-tree-model-account-types.[ch] from 
     Andreas Köhler <andi5.py@gmx.net>, plus the conversion of the Account 
     Dialog's account-types field to use the filtered GncTreeModelAccountTypes
     instead of a GtkListStore, but simplified to use the AccountType 
     selection functions.

r13267 | chris | 2006-02-15 09:58:34 -0500 (Wed, 15 Feb 2006) | 3 lines

   M /gnucash/trunk/configure.in

   Remove --enable-opt-style-install configure option.
   That's one less thing to test.

r13266 | chris | 2006-02-14 20:52:15 -0500 (Tue, 14 Feb 2006) | 15 lines

   M /gnucash/trunk/src/report/report-system/report-system.scm
   M /gnucash/trunk/src/report/report-system/report-utilities.scm
   M /gnucash/trunk/src/report/standard-reports/balance-sheet.scm
   M /gnucash/trunk/src/report/standard-reports/equity-statement.scm
   M /gnucash/trunk/src/report/standard-reports/income-statement.scm

   Changed balance calculations in three reports from using local
   copies of buggy accountlist-get-comm-balance-at-date to using a new
   gnc:accountlist-get-comm-balance-interval provided by
   report-utilities.scm.  For the affected calculations, the balances no 
   longer exclude transactions on the first day of the reporting period.  
   This fixes http://bugzilla.gnome.org/show_bug.cgi?id=331005.

   Changed calculations:
     Income Statement: Total Expenses, Total Revenues
     Balance Sheet: Retained Earnings (*)
     Equity Statement: Retained Earnings (*), Net Income

   (*) The Retained Earning calculations use a start-date of "forever-ago"
   so they are not affected, but still converted to the new function.

2006-02-14  Derek Atkins  <derek@ihtfp.com>

	* src/report/standard-reports/advanced-portfolio.scm:
	Andrew Sackville-West's patch to add display options and fix
	the multicurrency patch.  Fixes #314554 and #330577.

2006-02-14  Christian Stimming  <stimming@tuhh.de>

	* src/gnome/schemas/*.schemas.in: Make the gconf key wordings
	consistent across all of our schemas files, as discussed and
	prepared on http://wiki.gnucash.org/wiki/GConf_Wording .

	* src/import-export/hbci/gnc-hbci-utils.c: For latest aqbanking
	changes, define AQBANKING_NOWARN_DEPRECATED to disable aqbanking
	compiler warnings because we will still use those functions for
	some time to come.

2006-02-13  David Hampton  <hampton@employees.org>

	* src/gnome-utils/dialog-account.c:
	* src/gnome/glade/account.glade: Andreas Köhler's patch to convert
	the account types list in the account edit dialog to a
	GtkTreeView/GtkListStore.

	* src/gnome/gnc-plugin-page-register.c: Andreas Köhler's patch to
	prevent crash when voiding a transaction.

	* src/gnome/glade/sched-xact.glade:
	* src/gnome/glade/account.glade: Andreas Köhler's patch to wrap
	label text in a couple of dialogs.

2006-02-13  Derek Atkins  <derek@ihtfp.com>

	* src/backend/postgres/table.m4:
	  use glib macro instead of cast to convert pointer to int.
	  Fixes #330581.

	* src/report/standard-reports/advanced-portfolio.scm:
	  revert r13244 in this file because it's badly formed and
	  breaks the report.  Reopened bug #314554.

2006-02-12  Neil Williams <linux@codehelp.co.uk>

	* src/calculation/fin.c : Fix Bug 107876 - financial
	calculator would call exit(1) if calculation resulted
	in an interest rate of zero.

2006-02-12  Neil Williams <linux@codehelp.co.uk>

	* lib/libqof/qof/qofbackend.h : Add error value for files that
	cannot be opened. ERR_FILEIO_READ_ERROR.
	* lib/libqof/qof/qofsession.c : Improve QOF_TYPE_COLLECT handling 
	and recursive copies
	* lib/libqof/backend/file/qsf-backend.c : Check that files can be opened before
	trying to work out their type. Use new QofBackendError value
	if open to read fails.
	* src/engine/test-core/test-stuff.c : Ensuring get_random_double 
	returns at least some decimal places more often than not.

2006-02-12  Derek Atkins  <derek@ihtfp.com>

	* src/business/*/*.scm:
	  rename gnc:owner-get-address-dep to
	  gnc:owner-get-name-and-address-dep in preparation of
	  some other patches.

	* src/business/business-core/business-core.scm:
	  add gnc:owner-get-name-dep and gnc:owner-get-address-dep APIs
	* src/business/business-reports/fancy-invoice.scm:
	  Change the font of the client company name to match the
	  owner company name.  Fixes #327545.

	* src/business/business-utils/business-prefs.scm:
	* src/business/business-utils/business-utils.scm:
	  Add a bunch of new File -> Properties to describe the business.
	* src/business/business-reports/fancy-invoice.scm:
	  Parameterize all the various settings in the report so
	  they can all be set through the options or file->properties
	  settings.  Patch by "Brian", but slightly modified to not
	  hard-code some strings.

	* src/report/stylesheets/stylesheet-fancy.scm:
	  Des Dougan's patch to let the user choose the fancy-stylesheet
	  image alignment.  Fixes #314048.

	Mike Alexander's Currency Scrub patch.
        * src/engine/Scrub.c:
        * src/engine/Scrub.h:
          Try to fix transactions that have no currency, perhaps because
          of a log replay.  Workaround for bug #143720.

	Boris Zbarsky's advanced-portfolio patch.
	* src/report/standard-reports/advanced-portfolio.scm:
	  Apply dividend and brokerage to moneyin and moneyout to more
	  accurately reflect account activity.  Fixes bug #311549.

	Mike Alexander's patch to handle multiple currencies in reports.
        * src/report/standard-reports/portfolio.scm:
        * src/report/standard-reports/advanced-portfolio.scm:
          Report currency option
          Sort accounts
          Handle "nearest price" option better
        * src/report/standard-reports/cash-flow.scm:
          Handle multiple currencies better
        * src/report/standard-reports/transaction.scm:
          Add common currency option.
          Handle "nearest price" option better.
        * src/report/report-system/commodity-utilities.scm
          (gnc:exchange-by-pricedb-nearest):
          Use price nearest to noon on the day specified.
	Fixes bug #314554.

	Mike Alexander's reconcile preselection patch (#112653).
        * src/gnome/window-reconcile.c (gnc_reconcile_window_create_list_box):
        * src/gnome/reconcile-list.c (gnc_reconcile_list_new):
        * src/gnome/reconcile-list.h (gnc_reconcile_list_new):
          Don't pre-select the reconciled status for transactions after the
          statement date.
	Fixes #112653.

	Christian Neumair's desktop patch (#145545)
	* src/gnome/gnucash.desktop.in
	* src/gnome/Makefile.am
	  Make the desktop more HIG-compliant.

r13243 | chris | 2006-02-12 15:31:11 -0500 (Sun, 12 Feb 2006) | 3 lines

   M /gnucash/trunk/src/calculation/expression_parser.c

   Don't continue to parse the expression if we've already reached the end.
   Fixes http://bugzilla.gnome.org/show_bug.cgi?id=166840.


r13229 | chris | 2006-02-12 00:21:09 -0500 (Sun, 12 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome-utils/window-main-summarybar.c

   Use the price nearest to midday to get the value in the default currency.
   Patch by Mike Alexander <mta.umich.edu>, closes bug #330361


r13228 | chris | 2006-02-11 23:13:29 -0500 (Sat, 11 Feb 2006) | 4 lines

   M /gnucash/trunk/src/report/report-gnome/gnc-plugin-page-report.c

   Take #2:  Fixups for two botched gnc-plugin-page-report.c commits tonight.
   1) Correctly handle gc protection for non-boolean 'edited_reports' field.
   2) Pass list argument instead of immediate to gfec_apply.


r13227 | chris | 2006-02-11 21:40:35 -0500 (Sat, 11 Feb 2006) | 4 lines

   M /gnucash/trunk/src/report/report-gnome/gnc-plugin-page-report.c

   Gracefully handle errors in report options.
   This prevents the whole program from crashing when unrecognized report
   options are used.


r13223 | chris | 2006-02-11 16:07:32 -0500 (Sat, 11 Feb 2006) | 4 lines

   M /gnucash/trunk/src/report/report-system/Makefile.am
   M /gnucash/trunk/src/report/report-system/gnc-report.c

   gc_protect SCM reports while they are in the GHashTable.
   Also, use gfec to be a bit more defensive about potential errors while 
   running a report.


r13200 | chris | 2006-02-11 00:23:12 -0500 (Sat, 11 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome-utils/glade/preferences.glade

   Tweak the preferences labels for accounting periods.


r13199 | chris | 2006-02-11 00:14:21 -0500 (Sat, 11 Feb 2006) | 4 lines

   M /gnucash/trunk/src/app-utils/app-utils.scm
   M /gnucash/trunk/src/app-utils/date-utilities.scm
   M /gnucash/trunk/src/app-utils/gnc-accounting-period.h
   M /gnucash/trunk/src/app-utils/gw-app-utils-spec.scm
   M /gnucash/trunk/src/app-utils/options.scm

   Change the reports from using a hard-coded fiscal year to using the global
   accounting period set in the preferences.  Both the start date and the end
   date are used, so the user is free to choose any arbitrary period.


r13198 | chris | 2006-02-11 00:00:02 -0500 (Sat, 11 Feb 2006) | 3 lines

   M /gnucash/trunk/src/app-utils/gnc-accounting-period.c
   M /gnucash/trunk/src/app-utils/gnc-accounting-period.h
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.c
   M /gnucash/trunk/src/gnome-utils/window-main-summarybar.c
   M /gnucash/trunk/src/gnome-utils/window-main-summarybar.h

   Move the accounting period preference functions from window-main-summarybar
   to gnc-accounting-period.

2006-02-11  Derek Atkins  <derek@ihtfp.com>

	* src/report/report-gnome/gnc-plugin-page-report.c:
	  don't need to scm_gc_{un,}protect_object on SCM_BOOL_F.

	* src/business/business-reports/owner-report.scm:
	  set the document title properly AFTER type-str is set.

	* configure.in:
	  rework the initialization to require autoconf-2.59 and automake-1.9
	  parse the version out of the AC_PACKAGE_VERSION macro, so
	  we still only need to set it in one place.  This should
	  solve a number of old-automake related problems people have seen.

2006-02-11  David Hampton  <hampton@employees.org>

	* src/gnome/glade/acctperiod.glade:
	* src/gnome/glade/sched-xact.glade:
	* src/gnome/glade/account.glade: Patch from Tommi Vainikainen
	<tvainika@niksula.hut.fi> to remove extraneous line breaks.

	* src/backend/file/test/test-xml-commodity.c:
	* src/backend/file/gnc-commodity-xml-v2.c:
	* src/backend/postgres/table.m4:
	* src/import-export/ofx/gnc-ofx-import.c:
	* src/import-export/import-commodity-matcher.[ch]:
	* src/gnome-utils/gnc-tree-view-commodity.c:
	* src/gnome-utils/gnc-tree-model-commodity.[ch]:
	* src/gnome-utils/dialog-commodity.[ch]:
	* src/engine/gw-engine-spec.scm:
	* src/engine/test-core/test-engine-stuff.c:
	* src/engine/test/test-commodities.c:
	* src/engine/gnc-commodity.[ch]: Globally replace the words
	"exchange_code" with cusip in the source. No user visible changes.

2006-02-11  Christian Stimming  <stimming@tuhh.de>

	* po/Makevars: Add --keyword=Q_ to xgettext arguments so that
	translations with context prefix/disambiguation prefix are
	included as well.

2006-02-10  David Hampton  <hampton@employees.org>

	* src/gnome/gnc-plugin-page-account-tree.c: Correctly open an
	account and its sub-accounts. Fixes 330745.

2006-02-10  Derek Atkins  <derek@ihtfp.com>

	* src/gnome-utils/dialog-options.c:
	  Test for an empty string when translating.  (Fixes #330179)

	* Makefile.am:
	  added README.dependencies to the dist.  Fixes #330614.

	* configure.in:
	  check that we can find g-wrap-wct.h.
	  detects that we're running on a "broken" system like Ubuntu.
	  This is in response to #330539.

	* lib/libqof/qof/gnc-event.c:
	  Better handling of event removal.  This allows us to actually
	  clean up, but also makes sure we don't destroy the handler
	  list out from under us as we're processing events.

2006-02-09  David Hampton  <hampton@employees.org>

	* src/bin/gnucash-bin.c: Pass argc by reference instead of value
	so g_option_parse_context can update it.

	* src/bin/gnucash-bin.c: Don't initialize the display at option
	parsing time.  This way --add-price-quotes can run from a cron
	job.

	* src/gnome-utils/glade/commodity.glade:
	* src/gnome-utils/dialog-commodity.c:
	* src/engine/gnc-commodity.c: Update for known F::Q 1.11 quote
	sources.

	* src/quotes/finance-quote-check.in:
	* src/scm/price-quotes.scm: Print out the installed F::Q version
	at startup.
	
2006-02-09  Derek Atkins  <derek@ihtfp.com>

	* macros/legacy_macros.m4: when the guile version check fails,
	  print out the version of guile that we found in order to
	  aid debugging.

2006-02-09  David Hampton  <hampton@employees.org>

	* src/register/ledger-core/split-register-control.c: Better fix
	for the code that updates the buy/sell action based on the number
	of shares entered in a transaction.

r13167 | chris | 2006-02-09 00:23:51 -0500 (Thu, 09 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.c

   Remove forgotten unused variable.

r13165 | chris | 2006-02-08 23:53:43 -0500 (Wed, 08 Feb 2006) | 4 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.c

   Add two columns to the Accounts page: "Total (Period)" & "Balance (Period)"
   These are the recursive and non-recursive, respectively, period balances,
   where the accounting period is specified in the preferences.

r13158 | chris | 2006-02-08 23:17:27 -0500 (Wed, 08 Feb 2006) | 5 lines

   M /gnucash/trunk/src/gnome-utils/window-main-summarybar.c
   M /gnucash/trunk/src/gnome-utils/window-main-summarybar.h

   Fix an off-by-one (day) error in the dates used by the summarybar.
   Factor out and publicize functions to get the start and end of the
   accounting period in the preferences.
   Mark one comment as probably obsolete.


r13156 | chris | 2006-02-08 20:47:26 -0500 (Wed, 08 Feb 2006) | 4 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-view.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view.h

   Factor out an "approved" method for getting the GtkCellRenderer from a 
   GtkTreeViewColumn that's been added to a GncTreeView with one of the 
   convenience functions.


r13155 | chris | 2006-02-08 20:24:47 -0500 (Wed, 08 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome/Makefile.am
   D /gnucash/trunk/src/gnome/window-main-summarybar.c
   D /gnucash/trunk/src/gnome/window-main-summarybar.h
   M /gnucash/trunk/src/gnome-utils/Makefile.am
   A /gnucash/trunk/src/gnome-utils/window-main-summarybar.c (from /gnucash/trunk/src/gnome/window-main-summarybar.c:13154)
   A /gnucash/trunk/src/gnome-utils/window-main-summarybar.h (from /gnucash/trunk/src/gnome/window-main-summarybar.h:13154)

   Move window-main-summarybar.[ch] from gnome/ to gnome-utils/.
   It doesn't depend on anything in gnome/.


r13154 | chris | 2006-02-08 10:05:28 -0500 (Wed, 08 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome/gnc-plugin-page-register.c

   Change name of SplitRegister variable name to 'reg' for consistency.


r13153 | chris | 2006-02-08 10:00:24 -0500 (Wed, 08 Feb 2006) | 2 lines

   M /gnucash/trunk/src/report/report-system/html-document.scm

   A little error checking for report titles.


r13152 | chris | 2006-02-08 01:04:51 -0500 (Wed, 08 Feb 2006) | 6 lines

   M /gnucash/trunk/lib/libqof/qof/gnc-event.c

   Don't allow the event handler list to shrink while we're traversing it.
   This change isn't ideal in the sense that the handler list is now a 
   monotonically increasing resource, but it's better than crashing when the
   handler in node N+1 happens to be deleted while servicing the handler in
   node N.


r13150 | chris | 2006-02-08 00:55:04 -0500 (Wed, 08 Feb 2006) | 4 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-account.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-commodity.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-price.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model.h
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-commodity.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-price.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view.c

   Convert GncTreeModel from a GtkObject to a GObject.
   Replace gtk_object_sink calls on the models with g_object_unref calls.
   Correctly increase the refcount of "remembered" models when we return them.

2006-02-08  David Hampton  <hampton@employees.org>

	* src/register/ledger-core/split-register-control.c: Fix the code
	that updates the buy/sell action based on the number of shares
	entered in a transaction.

	* src/gnome/dialog-price-edit-db.c:
	* src/engine/gnc-pricedb.c: A couple of performance enhancements.

	* src/gnome/gnc-plugin-basic-commands.c: Set the busy cursor while
	the dialogs are being generated.

	* src/gnome/glade/commodities.glade:
	* src/gnome/glade/price.glade: Set the window type hint to normal.

	* src/gnome-utils/glade/commodity.glade: Fix a duplicate
	accelerator key.

2006-02-08  Chris Lyttle  <chris@wilddev.net>

	* NEWS: Added some text about the release.

2006-02-08  David Hampton  <hampton@employees.org>

	* src/gnome-search/search.glade: Set the default button. Fixes
	#329539.

2006-02-07  Christian Stimming  <stimming@tuhh.de>

	* po/glossary/gnc-glossary.txt: Update glossary with new term
	'voucher'.

r13149 | chris | 2006-02-07 21:23:59 -0500 (Tue, 07 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-commodity.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-price.c

   Convert GncTreeModelPrice and GncTreeModelCommodity to use GObject dispose
   path instead of GtkObject destroy path.


r13148 | chris | 2006-02-07 20:55:07 -0500 (Tue, 07 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-account.c

   Convert GncTreeModelAccount to use the GObject dispose path instead of 
   the GtkObject destroy path.  Also, remove the gconf callback during dispose.

r13140 | chris | 2006-02-07 14:52:29 -0500 (Tue, 07 Feb 2006) | 2 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c

   Recompute argc after argv may have changed.


r13134 | chris | 2006-02-06 15:41:40 -0500 (Mon, 06 Feb 2006) | 4 lines

   M /gnucash/trunk/src/engine/Transaction.c

   Fix two places where we were letting the split values become incoherent
   with account balances.
   Comment two possible bugs related to capgains and dirtying (or not) Splits.


r13133 | chris | 2006-02-06 13:31:49 -0500 (Mon, 06 Feb 2006) | 2 lines

   M /gnucash/trunk/src/backend/file/io-gncxml-v1.c

   Fix breakage from missed case in Split QofEntity->QofInstance conversion.


r13132 | chris | 2006-02-06 12:57:45 -0500 (Mon, 06 Feb 2006) | 4 lines

   M /gnucash/trunk/src/engine/Transaction.c

   Keep QOF aware of the dirty-state of Transactions.
   Also, dirty transactions upon changing due date and read-only status, 
   which didn't used to happen.


r13131 | chris | 2006-02-06 12:12:39 -0500 (Mon, 06 Feb 2006) | 4 lines

   M /gnucash/trunk/src/backend/postgres/txn.c
   M /gnucash/trunk/src/engine/Account.c
   M /gnucash/trunk/src/engine/Period.c
   M /gnucash/trunk/src/engine/Scrub2.c
   M /gnucash/trunk/src/engine/Transaction.c
   M /gnucash/trunk/src/engine/TransactionP.h
   M /gnucash/trunk/src/engine/cap-gains.c

   Convert Split from QofEntity to QofInstance.
   Let QofInstance manage the book pointer and kvp frame instead of Split 
   managing its own.


r13130 | chris | 2006-02-06 11:18:52 -0500 (Mon, 06 Feb 2006) | 2 lines

   M /gnucash/trunk/src/engine/Transaction.c

   Replace check_open() in setter API with internal qof_{begin,commit}_edit().


2006-02-06  David Hampton  <hampton@employees.org>

	* src/import-export/hbci/glade/hbci.glade:
	* src/report/report-gnome/report.glade:
	* src/gnome/glade/budget.glade:
	* src/gnome/glade/tax.glade:
	* src/gnome/glade/account.glade:
	* glade-fixup: Filter out more post gtk2.4 properties.
	
	* src/bin/gnucash-bin.c: Fix some issues when invoking from a
	non-utf8, non latin1 locale.  Use g_print to print to the
	console. Convert from popt to g_options for glib >= 2.6.  Fixes
	#328991.

	* src/register/register-gnome/gnucash-item-edit.c:
	* src/register/register-gnome/gnucash-grid.c: Scott Oonk' patch to
	fix a couple of problems with right justified cells in the
	register.

	- Make sure the text in the cell stays right justified when
	deleting characters.
	- Adjust the positioning of text to account for the popup toggle.
	- Change gnucash-item-edit to use logical extents instead of ink
	extents.  This syncs gnucash-item-edit.c with change made to
	gnucash-grid.c in r12155.

2006-02-05  Derek Atkins  <derek@ihtfp.com>

	* src/backend/file/test/Makefile.am: link against libcore-utils.

	* src/app-utils/test/test-scm-query-string.c:
	  use g_strdup -- cannot feed SCM_STRING_CHARS() back into guile.
	  (fixes a weird test-case failure in some cases).

	* src/backend/file/Makefile.am: link against libcore-utils.

	* src/engine/test/test-engine-stuff.c:
	  - make sure a random group always has at least two accounts
	  - fix "make random transaction" to tell us when we don't
	    have at least two accounts.
	  - free the results of xaccGroupGetSubAccounts().

	* src/engine/test/test-engine-stuff.c:
	  - better fix for #accounts
	  - don't g_list_free the account_list

2006-02-05  Neil Williams <linux@codehelp.co.uk>

	* lib/libqof/qof/qoflog.c :
	* lib/libqof/qof/qoflog.h :
	* lib/libqof/qof/deprecated.c :
	* lib/libqof/qof/deprecated.h : Deprecating qof_log_set_level_global
	in favour of qof_log_set_level_registered. Documenting circumstances
	under which _global could be modified and added as a new function.
	Improve qof_log_check to handle out-of-bounds log_levels.

2006-02-05  Neil Williams <linux@codehelp.co.uk>

	* lib/libqof/qof/qofbackend-p.h :
	* lib/libqof/qof/qofbackend.h : Improving
	documentation for QofBackendProvider
	* lib/libqof/qof/qofchoice.c :
	* lib/libqof/qof/qofchoice.h : Support logging.
	* lib/libqof/qof/qoflog.c : Add qofchoice to default
	log modules.
	* lib/libqof/qof/gnc-engine-util.h : Line-wrapping tweak.	

r13128 | chris | 2006-02-05 23:50:02 -0500 (Sun, 05 Feb 2006) | 9 lines

   M /gnucash/trunk/src/engine/Transaction.c

   Remove check_open() calls from Transaction setters.

   These calls were probably a copied idiom from the Split setters in this
   same file, but Split and Transaction use completely different mechanisms
   for managing dirty state.  Transactions inherit from QofInstance and so
   use the .dirty field.  Splits inherit from QofEntity, so their
   check_open(split->parent) calls are their way of letting someone know
   they've changed.


r13096 | chris | 2006-02-04 11:34:57 -0500 (Sat, 04 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome/gnc-plugin-page-budget.c

   Hook-up the new budget value estimation dialog.


r13095 | chris | 2006-02-04 11:32:30 -0500 (Sat, 04 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome/glade/budget.glade

   New dialog for estimating budget values from past transactions.
   Minor string and glade tweaks.


r13094 | chris | 2006-02-04 11:29:00 -0500 (Sat, 04 Feb 2006) | 2 lines

   M /gnucash/trunk/src/gnome-utils/gnc-date-edit.c
   M /gnucash/trunk/src/gnome-utils/gnc-date-edit.h

   gnc_date_edit_set_gdate(): A GDate setter for GNCDateEdit is useful, too. 


r13093 | chris | 2006-02-04 10:17:51 -0500 (Sat, 04 Feb 2006) | 3 lines

   M /gnucash/trunk/src/gnome-utils/gnc-date-edit.c
   M /gnucash/trunk/src/gnome-utils/gnc-date-edit.h

   Add getter gnc_date_edit_get_gdate() for getting the value of a GNCDateEdit
   widget as a GDate.


r13092 | chris | 2006-02-04 10:12:09 -0500 (Sat, 04 Feb 2006) | 5 lines

   M /gnucash/trunk/src/engine/Recurrence.c
   M /gnucash/trunk/src/engine/Recurrence.h
   M /gnucash/trunk/src/engine/gnc-budget.c

  Factor out some code from gnc-budget into Recurrence so that the budget
  estimation code can use stand-alone recurrences to estimate budget values.
  Also, tweak the initial budget so that it begins at the beginning of the 
  current month.


r13091 | chris | 2006-02-04 10:06:19 -0500 (Sat, 04 Feb 2006) | 2 lines

   M /gnucash/trunk/src/app-utils/gnc-ui-util.c

   Teach PrintAmountInternal() to correctly handle a reciprocal denominator.


r13090 | chris | 2006-02-04 00:37:50 -0500 (Sat, 04 Feb 2006) | 9 lines

   M /gnucash/trunk/src/engine/test/test-numeric.c

   Add some test-cases for gnc_numerics using the reciprocal denominator.
   Even though we don't explicitly ask for this representation, certain
   calculations (e.g. those involving GNC_HOW_DENOM_SIGFIGS in the loan    
   druid and soon in budgets) will return numbers using this representation.

   Unfortunately, these numbers aren't handled correctly by most of the
   gnc_numeric functions, like the ones for comparison, equality testing,
   arithmetic and conversion.


2006-02-04  David Hampton  <david@dhcp-15.rainbolthampton.net>

	* src/register/ledger-core/split-register.c:
	* src/gnome-utils/gnc-tree-view-account.c: Get gnucash to compile
	with gcc4.1.

2006-02-04  Derek Atkins  <derek@ihtfp.com>

	* lib/libqof/qof/gnc-numeric.c:
	  - Fixes for handling reciprocal values.
	  - Mark a lot of places where potential overflow bugs
	    are not handled.

2006-02-04  Joshua Sled  <jsled@asynchronous.org>

	* src/doc/xml/gnucash-v2.rnc: Add reverse-engineered schema for
	"v2" (1.8/2.0) XML files.

	* src/backend/file/io-gncxml-v2.c (write_v2_header): Emit
	'fs' (FreqSpec), 'bgt', 'recurrence' (Budgeting), and 'lot'
	namespace decls.

2006-02-04  David Hampton  <hampton@employees.org>

	* src/import-export/schemas/Makefile.am:
	* src/import-export/hbci/schemas/Makefile.am:
	* src/business/business-gnome/schemas/Makefile.am:
	* src/gnome-utils/schemas/Makefile.am:
	* src/gnome/schemas/Makefile.am: Don't just install the schema
	files, also install the gconf objects into the database. Reverts
	accidental change made as part of r12863.

2006-02-04  Joshua Sled  <jsled@asynchronous.org>

	* src/report/report-system/html-document.scm
	(gnc:html-document-headline): Add a headline property to the
	html-document record.

	* src/report/report-system/html-style-sheet.scm
	(gnc:html-style-sheet-render): Add headline-copy, better comment.

	* src/report/stylesheets/stylesheet-plain.scm (plain-renderer) 
	* src/report/stylesheets/stylesheet-fancy.scm (fancy-renderer) 
	* src/report/stylesheets/stylesheet-easy.scm (easy-renderer):
	Use headline if available, fallback to title. 

	* src/business/business-reports/aging.scm (aging-renderer)
	* src/business/business-reports/owner-report.scm (reg-renderer): 
	Use strings in titles, markup for the richer headline. Bug#329369.

2006-02-04  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-tree-view-commodity.c:
	* src/gnome-utils/gnc-tree-view-account.c: Add disambiguating
	prefix to the single letter column titles.

	* src/report/stylesheets/stylesheet-fancy.scm:
	* src/report/stylesheets/stylesheet-easy.scm: Dave Herman's
	<dvherman@gmail.com> patch to fix #327630 by copying missing
	"function" (gnc:html-document-set-style!) from the plain to both
	the "fancy" and "easy" stylesheets.

	* src/gnome-utils/gnc-tree-view-commodity.c:
	* src/gnome-utils/gnc-tree-view-price.c:
	* src/gnome-utils/gnc-tree-view-account.c:
	* src/gnome-utils/gnc-tree-view.c: Andreas Köhler's patch to
	perform the i18n on column headers before calling the generic tree
	view code instead of performing it a couple steps removed.  This
	is a leftover from several years ago when the columns were defined
	in an array. It also introduces the translatable strings
	"P" (placeholder) and "Q" (quotes) used in toggle column headers.

2006-02-04  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome-utils/glade/preferences.glade: Fix name of
	file-compression option.

	* src/backend/file/gnc-backend-file.c (gnc_backend_new): Setup
	option initial values; register configuration-change notification.
	(retain_changed_cb, compression_changed_cb): Add.

	* src/backend/file/gnc-backend-file.h (struct FileBackend_struct):
	Move backend options into backend struct.

2006-02-03  David Hampton  <hampton@employees.org>

	* src/business/business-gnome/dialog-order.c:
	* src/business/business-gnome/dialog-vendor.c:
	* src/business/business-gnome/dialog-customer.c:
	* src/business/business-gnome/dialog-job.c:
	* src/business/business-gnome/dialog-employee.c:
	* src/business/business-gnome/dialog-invoice.c:
	* src/gnome/dialog-find-transactions.c:
	* src/gnome-search/search.glade:
	* src/gnome-search/dialog-search.[ch]: Re-title the search dialog
	based upon the menu used to invoke it. Fixes #329538.

r13089 | chris | 2006-02-03 16:29:06 -0500 (Fri, 03 Feb 2006) | 4 lines

   M /gnucash/trunk/src/engine/gnc-budget.c

   Use the string cache for budget name and description.
   Dirty the book when the budget changes.
   Remove some obsolete budget code.


r13079 | chris | 2006-02-02 13:47:34 -0500 (Thu, 02 Feb 2006) | 4 lines

   M /gnucash/trunk/Makefile.am
   M /gnucash/trunk/make-gnucash-potfiles.in

   Allow make-gnucash-potfiles to run from directories other than srcdir.
   Better documentation of exactly what m-g-potfiles excludes, and a general
   clean-up of the script.


2006-02-02  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-tree-view.[ch]: Andreas Köhler's patch to
	allow explicit specification of which columns in a tree view
	expand.  Updated to automatically mark a column as expandable if
	it is the only visible column.

	* src/business/dialog-tax-table/dialog-tax-table.c:
	* src/gnome-utils/gnc-tree-view-account.c:
	* src/gnome-utils/dialog-account.c:
	* src/gnome/gnc-plugin-page-account-tree.c:
	* src/gnome/druid-stock-split.c:
	* src/gnome/dialog-tax-info.c:
	* src/gnome/druid-hierarchy.c: Change the default visibilities of
	the GncTreeViewAccount widget to only show the account name
	column.  This is the most commonly used case for this widget.

2006-02-02  Joshua Sled  <jsled@asynchronous.org>

	* lib/libqof/qof/qofsession.c (qof_session_load_backend): get+load
	backend configuration after creation.
	* src/backend/file/gnc-backend-file.c (gnc_file_be_get_config):
	fix configuration.
	(gnc_file_be_remove_old_files): Add ".log" suffix to the
	check for to-remove files.  Bug#329670.  Reformat.

2006-02-02  David Hampton  <hampton@employees.org>

	* src/register/register-core/numcell.c: Don't call g_utf8_strlen
	with a NULL pointer.  Fixes 329556.

	* src/gnome-utils/gnc-tree-model-commodity.c:
	* src/gnome-utils/gnc-tree-model-account.c:
	* src/gnome-utils/gnc-tree-model-price.c: Better handling in the
	model event handling functions.  Noticeable in the commodity and
	price trees when adding/deleting the first/last item.

	* src/gnome/dialog-commodities.c: Fix a crash when manipulating
	commodities before crating the first account.

	* src/gnome-utils/gnc-file.c: Re-enable events before processing
	the book-opened hook.  Solves some strange problems in the account
	tree which were caused by the Orphan account being created during
	the callbacks, but no event being sent to the account tree model.

2006-02-02  Derek Atkins  <derek@ihtfp.com>

	* src/backend/file/io-gncxml-v2.c:
	  Specify the output xml encoding as utf8.

2006-02-01  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-core/gncInvoice.c:
	  Need to put the new split into the txn as well as the acct
	  before we call xaccSplitSetBaseValue().  Fixes #325890.

	* src/business/business-core/gncInvoice.[ch]:
	  Add new API: gncInvoiceSortEntries()
	* src/business/business-core/gncEntry.c:
	  re-sort the parent when the entry date changes.
	  Only re-sort when the existing date is non-zero (i.e.
	  don't re-sort on the initial setting of the date).
	  Fixes #320566.

	* src/gnome-search/dialog-search.c:
	* src/gnome-search/dialog-search.h:
	  Modify the gnc_search_dialog_create() API to add an optional
	  "type label" parameter, so you can manually set the string
	  presented to the user for what they are searching for...
	* src/business/business-gnome/dialog-order.c:
	* src/business/business-gnome/dialog-vendor.c:
	* src/business/business-gnome/dialog-customer.c:
	* src/business/business-gnome/dialog-job.c:
	* src/business/business-gnome/dialog-employee.c:
	* src/gnome/dialog-find-transactions.c:
	  Pass NULL into new search API parameter
	* src/business/business-gnome/dialog-invoice.c:
	  Modify how we call the search dialog.  Send in different
	  sets of parameters depending on whether we're searching for
	  a Customer Invoice, Vendor Bill, or Employee Expense Voucher.
	  Pass in a type_label as well so the dialog can properly label
	  the "new" button.  This fixes the UI Bug #117354.

r13072 | chris | 2006-02-01 19:07:58 -0500 (Wed, 01 Feb 2006) | 2 lines

   M /gnucash/trunk/Makefile.am
   M /gnucash/trunk/po/POTFILES.skip

   Check for any accidentally-distributed files not marked for translation.


r13070 | chris | 2006-02-01 17:38:41 -0500 (Wed, 01 Feb 2006) | 2 lines

   M /gnucash/trunk/Makefile.am

   Add POTFILES.skip to EXTRA_DIST.


r13067 | chris | 2006-02-01 15:33:36 -0500 (Wed, 01 Feb 2006) | 2 lines

   A /gnucash/trunk/po/POTFILES.skip

   Don't translate obsolete files.


r13066 | chris | 2006-02-01 15:32:11 -0500 (Wed, 01 Feb 2006) | 2 lines

   M /gnucash/trunk/make-gnucash-potfiles.in

   When generating POTFILES.in, don't include files we don't want to translate.


r13065 | chris | 2006-02-01 15:30:14 -0500 (Wed, 01 Feb 2006) | 3 lines

   M /gnucash/trunk/Makefile.am

   Fail 'make distcheck' if POTFILES.in contains undistributed files.
   The failure will also helpfully explain which files are the problem.


2006-01-31  Derek Atkins  <derek@ihtfp.com>

	* configure.in: include gmodule in GLIB_LIBS
	* lib/libqof/qof/Makefile.am: link libqof against glib.

2006-01-30  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome-utils/gnc-html-graph-gog.c (read_doubles): Explicitly
	enter the C locale before calling sscanf on doubles string-ified
	by guile.  Bug#328773.

2006-01-30  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-core/gncInvoice.c:
	  Make sure to insert new splits into an account before we
	  set the Base Value..  Otherwise it will fail to set the
	  value properly.  Closer to fixing 325890, but it's still
	  not completely fixed.

2006-01-30  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/glade/sched-xact.glade: Change since-last-run
	final-page text from "apply" to "Apply". Bug#329125.

r13056 | chris | 2006-01-30 22:41:01 -0500 (Mon, 30 Jan 2006) | 2 lines

   M /gnucash/trunk/src/report/locale-specific/us/taxtxf-de_DE.scm
   M /gnucash/trunk/src/report/locale-specific/us/taxtxf.scm

   Don't add markup to tax report titles.


r13047 | chris | 2006-01-29 22:53:09 -0500 (Sun, 29 Jan 2006) | 4 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-view.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view.h

   New function: gnc_tree_view_add_combo_column().
   This function is only compiled when HAVE_GTK26 because it uses 
   GtkCellRendererCombo.


r13045 | chris | 2006-01-29 21:59:43 -0500 (Sun, 29 Jan 2006) | 3 lines

   M /gnucash/trunk/src/engine/Transaction.c
   M /gnucash/trunk/src/engine/Transaction.h
   M /gnucash/trunk/src/engine/TransactionP.h

   Add some convenience functions for getting values from various combinations
   of Accounts, Transactions, and Splits.


r13040 | chris | 2006-01-29 19:59:25 -0500 (Sun, 29 Jan 2006) | 3 lines

   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.h

    Convert account types filter dialog to use checkboxes for selection.
    Patch by Eskil Bylund <eskil.bylund@gmail.com>


2006-01-29  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-core/file/gnc-bill-term-xml-v2.c:
	* src/business/business-core/file/gnc-bill-term-xml-v2.h:
	  Add a new API to "find-or-create" a billterm so all the
	  code is collated in one location.
	  Add more debugging during the scrub phases.
	* src/business/business-core/file/gnc-invoice-xml-v2.c:
	* src/business/business-core/file/gnc-vendor-xml-v2.c:
	* src/business/business-core/file/gnc-customer-xml-v2.c:
	  Use the new bill-term find-or-create API
	* src/business/business-core/gncBillTerm.c:
	  add some additional debugging
	* src/business/business-core/gncBillTerm.h:
	  The Billterm Type ENUM must start at 1, not zero.  The data file
	  now appears to properly save itself without destroying data.
	  Fixes rest of #328790.

2006-01-29  David Hampton  <hampton@employees.org>

	* src/gtk-compat.h:
	* src/gnome-utils/gnc-main-window.c:
	* src/Makefile.am: Make the cut/paste change compile on gtk 2.4
	systems.

	* various: Remove extraneous carriage returns from text that will
	be put into a GtkLabel (since labels know how to wrap text).

	* src/report/stylesheets/stylesheet-fancy.scm : Dave Herman's
	patch to suppresses extraneous entries table entries in reports
	when there are no files specified for the "logo pix" file or the
	"header pix" file.

	* src/gnome-utils/gnc-main-window.c: Eskil Bylund's patch from
	Epiphany to enable cut/paste.  Extended to support GtkTextView
	widgets as well as GtkEditable widgets.

	* src/gnome-utils/gnc-main-window.c: Andreas Köhler's patch to fix
	a problem where switching windows repeatedly confusing the
	Windows menu. Fixes #327943.

	* gnc-tree-model-commodity.c: Andreas Köhler's patch to fix
	commodity editor warnings/crash. Fixes #328788.

2006-01-29  Joshua Sled  <jsled@asynchronous.org>

	* src/report/utility-reports/welcome-to-gnucash.scm: register
	menu item for self.

	* src/report/report-gnome/report-gnome.scm
	(gnc:report-menu-setup): Remove report menu-item creation.

	* src/gnome/dialog-sxsincelast.c (create_each_transaction_helper):
	Degrade more gracefully in the face of errors during scheduled-transaction
	creation; record errors in-band rather than simply to the log, and
	display them to the user.  Resolves bugs: 151157, 167858, 151487.

2006-01-29  David Hampton  <hampton@employees.org>

	* src/register/ledger-core/split-register.c:
	* src/register/ledger-core/split-register-control.c:
	* src/import-export/hbci/druid-hbci-initial.c:
	* src/report/report-gnome/gnc-plugin-page-report.c:
	* src/gnome-utils/gw-gnome-utils-spec.scm:
	* src/gnome-utils/gnc-gui-query.c:
	* src/gnc-ui.h: HIG changes for the "radio option" query dialog.

	* src/engine/gnc-engine.c: Restore reasonable default logging
	levels.

	* README: Michael Wahlbrink's cvs to svn changes.

	* src/import-export/qif-import/dialog-account-picker.c:
	* src/import-export/hbci/gnc-hbci-gettrans.c:
	* src/import-export/hbci/hbci-interaction.c:
	* src/report/report-gnome/window-report.c:
	* src/gnome-utils/gnc-file.c:
	* src/gnome/gnc-plugin-page-account-tree.c:
	* src/gnome-search/search-string.c: Use a format string of "%s"
	when building a message dialog from a single string.

	* src/gnome-utils/gnc-main-window.c:
	* src/gnome/gnc-split-reg.c:
	* src/gnome/dialog-commodities.c:
	* src/gnome/dialog-price-edit-db.c: Use the gtk2.6 secondary
	message text function now that there is a 2.4 emulation routine
	available.

	* src/gnome-utils/gncmod-gnome-utils.c:
	* src/app-utils/gnc-err-popup.[ch]:
	* src/app-utils/Makefile.am: Remove deprecated files

	* src/register/ledger-core/split-register-model.c:
	* src/register/ledger-core/split-register.c:
	* src/register/ledger-core/split-register-control.c:
	* src/import-export/hbci/dialog-pass.c:
	* src/business/business-ledger/gncEntryLedger.c:
	* src/business/business-ledger/gncEntryLedgerControl.c:
	* src/business/business-gnome/gnc-plugin-business.c:
	* src/gnome-utils/gnc-gnome-utils.c:
	* src/gnome-utils/gw-gnome-utils-spec.scm:
	* src/gnome-utils/gnc-file.[ch]:
	* src/gnome-utils/gnc-main-window.c:
	* src/gnome-utils/dialog-utils.[ch]:
	* src/gnome-utils/gnc-gui-query.[ch]:
	* src/gnome/gnc-split-reg.c:
	* src/gnome/dialog-chart-export.c:
	* src/gnome/schemas/apps_gnucash_warnings.schemas.in:
	* src/gnome/dialog-commodities.c:
	* src/gnome/dialog-price-edit-db.c:
	* src/gnc-ui.h:
	* src/app-utils/option-util.c: HIG rework. Remove newlines from
	dialog message strings.  Give some dialogs more descriptive button
	labels.  Clean up the code around the file save query dialog.


2006-01-28  Joshua Sled  <jsled@asynchronous.org>

	* src/report/report-system/html-style-sheet.scm
	(gnc:html-style-sheet-render): Maintain the html-document title
	while rendering so the progress bar is setup with the right name.
	Bug#327650.

2006-01-28  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/gnc-split-reg.c: Remove a lot of dead code.
	(gnc_split_reg_new): Remove create-flags and
	disallowed-cap[abilitie]s; add simple "read-only" flag.

	* src/gnome/gnc-plugin-page-register.c
	(gnc_plugin_page_register_actions): remove stock-missing icon for
	"edit exchange rate" action.
	(GncPluginPageRegisterPrivate, gnc_plugin_page_register_init) 
	(gnc_plugin_page_register_create_widget): Replace "disallow
	cap[abilitie]s" with specific read-only flag.

	* src/gnome/dialog-scheduledxaction.c (schedXact_editor_create_ledger): 
	* src/gnome/dialog-sxsincelast.c (create_to_create_ledger) 
	(create_autoCreate_ledger, create_created_ledger): Set read-only
	flag on register.

2006-01-28  David Hampton  <hampton@employees.org>

	* src/gnome-utils/print-session.h: Add an include so gnucash
	compiles on gnome2.13 again.

2006-01-28  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/gnc-plugin-page-register.c (gnc_plugin_page_register_cmd_reverse_transaction) 
	(gnc_plugin_page_register_cmd_view_sort_by) 
	(gnc_plugin_page_register_cmd_view_filter_by) 
	(gnc_plugin_page_register_cmd_transfer) 
	(gnc_plugin_page_register_cmd_reconcile) 
	(gnc_plugin_page_register_cmd_jump): Treat
	GNC_PLUGIN_PAGE(page)->window as a GncWindow, not necessarily and
	immediately a GtkWindow; fixes issues with GTK cast warnings on
	GncEmbeddedWindow usages of the register.

2006-01-28  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/ui/gnc-sxed-window-ui-full.xml: Add.
	* src/gnome/dialog-scheduledxaction.c (gnc_sxed_menu_entries) 
	(schedXact_editor_create_ledger)
	* src/gnome/dialog-sxsincelast.c (create_autoCreate_ledger) 
	(create_created_ledger, create_to_create_ledger) 
	(gnc_sxsld_menu_entries): Setup SX-related registers to only
	display and allow relevant register functionality. Bug#327642.

	* src/gnome/gnc-plugin-page-register.c
	(gnc_plugin_page_register_actions): Change stock icons for
	BlankTransaction and ScheduleTransaction Actions.

2006-01-28  Joshua Sled  <jsled@asynchronous.org>

	* lib/libgsf-1.12.3/gsf-gnome/Makefile.am (pkglib_LTLIBRARIES)
	* lib/libgsf-1.12.3/gsf/Makefile.am (pkglib_LTLIBRARIES)
	* lib/goffice-0.0.4/goffice/Makefile.am (pkglib_LTLIBRARIES)
	* configure.in: Use pkglib automake variables to install in a
	gnucash-specific hierearchy; change configure.in paths for goffice
	for similar reasons.  Bug#328858.

2006-01-25  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/glade/sched-xact.glade: Bug#327775: consistency in
	case of dialog title.
	Bug#327641: fix glade-spec'ed response-codes for OK/Cancel
	buttons, thus letting logic work again.

2006-01-28  Christian Stimming  <stimming@tuhh.de>

	* configure.in: Revert aqbanking dependency. We still stick to
	1.0.0 because a) FC3 has AQBANKING 1.0.x, b) We can't find an
	AQBANKING 1.3 tarball -- the earliest we can find is 1.6, c)
	AQBANKING 1.6 doesn't build on FC3 because of dependencies

2006-01-28  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-core/file/gnc-owner-xml-v2.c:
	  GncOwner is not a QOF_INSTANCE.  Get the GUID correctly.
	  Fixes part of #328790 (but not all of it).

2006-01-28  Christian Stimming  <stimming@tuhh.de>

	* configure.in: For HBCI, require aqbanking >= 1.3.0 (released
	2005-08-11) since current aqbanking is beyond 1.9.x and those
	really old versions had to deal with very different packaging
	structure.

r13010 | chris | 2006-01-28 15:30:23 -0500 (Sat, 28 Jan 2006) | 5 lines

   M /gnucash/trunk/src/gnome/gnc-plugin-page-register.c

   Automatically close registers whose accounts are deleted.
   We use the component manager to watch for the destruction of the account.
   Previously, having an account's register open while deleting it would
   just crash.

r12999 | chris | 2006-01-28 12:17:49 -0500 (Sat, 28 Jan 2006) | 3 lines

   M /gnucash/trunk/lib/libqof/qof/qoflog.c

   Re-enable logging for GnuCash modules that haven't explicitly set their
   own levels.

r12997 | chris | 2006-01-28 01:05:54 -0500 (Sat, 28 Jan 2006) | 3 lines

   M /gnucash/trunk/src/gnome/gnc-plugin-page-budget.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-view-account.c

   Remove obsolete code to handle account-types filtering for budgets.
   Really remove treeviewcolumns when we're done with them.

r12995 | chris | 2006-01-27 23:14:56 -0500 (Fri, 27 Jan 2006) | 2 lines

   M /gnucash/trunk/src/report/standard-reports/budget.scm

   Better default account selection when opening the budget report.


r12994 | chris | 2006-01-27 21:23:38 -0500 (Fri, 27 Jan 2006) | 2 lines

   M /gnucash/trunk/gnucash.m4

   Remove traces of old gnucash-run-script from gnucash.m4.


r12993 | chris | 2006-01-27 18:03:23 -0500 (Fri, 27 Jan 2006) | 3 lines

   M /gnucash/trunk/src/report/report-gnome/gnc-plugin-page-report.c
   M /gnucash/trunk/src/report/report-system/gnc-report.c
   M /gnucash/trunk/src/report/report-system/gnc-report.h
   M /gnucash/trunk/src/report/report-system/gw-report-system-spec.scm
   M /gnucash/trunk/src/report/report-system/report.scm

   Move generation of report serial ids from guile to C.
   Try to gracefully handle more errors during report loading.


r12989 | chris | 2006-01-27 01:15:31 -0500 (Fri, 27 Jan 2006) | 3 lines

   M /gnucash/trunk/src/report/report-gnome/window-report.c
   M /gnucash/trunk/src/report/report-system/report.scm

   Check for invalid options tables when loading reports.
   Also, plug memory leak in my last commit.


r12988 | chris | 2006-01-27 00:27:08 -0500 (Fri, 27 Jan 2006) | 2 lines

   M /gnucash/trunk/src/report/report-gnome/gnc-plugin-page-report.c
   M /gnucash/trunk/src/report/report-gnome/window-report.c

   Avoid showing any invalid reports.


2006-01-27  David Hampton  <hampton@employees.org>

	* src/scm/printing/print-check.scm:
	* src/gnome/glade/print.glade:
	* src/gnome/dialog-print-check.c: Add translation and rotation to
	the custom printing page.  Modify the code so that only the custom
	widgets that have an effect for the current setting are sensitive.

2006-01-27  Derek Atkins  <derek@ihtfp.com>

	Get "make distcheck" to work....
	* src/import-export/test/Makefile.am:
	  Added src/scm directory to test environment
	* lib/goffice-0.0.4/Makefile.am:
	  Don't install libgoffice-1.pc, but distribute it
	* lib/libgsf-1.12.3/tests/Makefile.am:
	  Link to the proper location of libgsf-1.la
	* lib/libgsf-1.12.3/Makefile.am:
	  Don't install the gsf .pc files, but distribute them.
	* lib/Makefile.am:
	  Use DIST_SUBDIRS to distribute qof, gsf, and goffice
	* configure.in:
	  fix QOF_LIBS to use builddir, not srcdir
	* Makefile.am:
	  add po/POTFILES.in to the dist
	  link gsf into the srcdir, not the builddir
	* src/report/report-system/Makefile.am:
	  make sure we distribute gw-report-system.h
	* src/bin/Makefile.am:
	  clean i18n.h in distclean

2006-01-26  David Hampton  <hampton@employees.org>

	* configure.in: Default the --enable-compile-warnings argument to
	yes.

	* src/gnome/window-reconcile.c:
	* src/gnome/glade/tax.glade:
	* src/gnome/glade/reconcile.glade:
	* src/gnome/dialog-tax-info.c: More HIG changes.

	* src/report/report-system/gnc-report.[ch]:
	* src/report/report-gnome/window-report.[ch]:
	* src/gnome/top-level.c: Fix compilation warnings.

2006-01-26  Derek Atkins  <derek@ihtfp.com>

	* configure.in: fail if we find libgsf >= 1.12.2 but not libgsf-gnome.
	  This is instead of configure succeeding and then failing the
	  build later.

r12985 | chris | 2006-01-26 23:38:47 -0500 (Thu, 26 Jan 2006) | 2 lines

   M /gnucash/trunk/src/gnome-utils/gnc-main-window.c

   Avoid saving invalid pages.


r12984 | chris | 2006-01-26 21:12:41 -0500 (Thu, 26 Jan 2006) | 13 lines

   M /gnucash/trunk/src/gnome/top-level.c
   M /gnucash/trunk/src/report/report-gnome/dialog-column-view.c
   M /gnucash/trunk/src/report/report-gnome/dialog-style-sheet.c
   M /gnucash/trunk/src/report/report-gnome/gnc-plugin-page-report.c
   M /gnucash/trunk/src/report/report-gnome/window-report.c
   M /gnucash/trunk/src/report/report-gnome/window-report.h
   M /gnucash/trunk/src/report/report-system/Makefile.am
   M /gnucash/trunk/src/report/report-system/gnc-report.c
   M /gnucash/trunk/src/report/report-system/gnc-report.h
   A /gnucash/trunk/src/report/report-system/gw-report-system-spec.scm
   M /gnucash/trunk/src/report/report-system/html-style-sheet.scm
   M /gnucash/trunk/src/report/report-system/report-system.scm
   M /gnucash/trunk/src/report/report-system/report.scm
   M /gnucash/trunk/src/report/utility-reports/view-column.scm
   M /gnucash/trunk/src/report/utility-reports/welcome-to-gnucash.scm
   M /gnucash/trunk/src/scm/main-window.scm
   M /gnucash/trunk/src/scm/main.scm

   Move the global report hash-table from guile to C.
   Move the book-open/close hooks from guile to C.

   There are several places where we do report-management from C already.
   Those places no longer use libguile to access the hash-table of reports -
   they can just call C functions.

   For now, there's still some report-management happening in guile so guile
   can access the global state through g-wrapped functions.  Eventually, 
   all report-management should be in C and guile can just provide single
   reports one-at-a-time.
   

r12982 | chris | 2006-01-26 12:38:26 -0500 (Thu, 26 Jan 2006) | 4 lines

   M /gnucash/trunk/src/gnome/top-level.c
   M /gnucash/trunk/src/gnome-utils/gnc-main-window.c
   M /gnucash/trunk/src/gnome-utils/gnc-main-window.h

   Register book open/close callbacks during gui init.
   Split handling of persistent application state into book-level data 
   and window-level data.


r12980 | chris | 2006-01-25 23:02:47 -0500 (Wed, 25 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/overrides/Makefile.am
   D /gnucash/trunk/src/bin/overrides/gnucash-run-script
   M /gnucash/trunk/src/bin/test/Makefile.am
   D /gnucash/trunk/src/bin/test/test-run-script
   M /gnucash/trunk/src/scm/main.scm

   Remove the obsolete gnucash-run-script and its test.
   Also, the (gnucash main) module no longer depends on (gnucash price-quotes).


r12979 | chris | 2006-01-25 22:07:03 -0500 (Wed, 25 Jan 2006) | 4 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/gnome/Makefile.am
   D /gnucash/trunk/src/gnome/dialog-totd.c
   D /gnucash/trunk/src/gnome/dialog-totd.h
   M /gnucash/trunk/src/gnome/top-level.c
   M /gnucash/trunk/src/gnome-utils/Makefile.am
   A /gnucash/trunk/src/gnome-utils/dialog-totd.c (from /gnucash/trunk/src/gnome/dialog-totd.c:12978)
   A /gnucash/trunk/src/gnome-utils/dialog-totd.h (from /gnucash/trunk/src/gnome/dialog-totd.h:12978)
   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.c

   Move dialog-totd from gnome to gnome-utils.
   Do low-level application initialization even before booting guile.
   This means the splash and totd come up almost instantly. 


r12978 | chris | 2006-01-24 23:54:12 -0500 (Tue, 24 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/main.scm
   M /gnucash/trunk/src/scm/price-quotes.scm

   Install price quote sources without calling main.scm.
   This makes the startup sequence a little clearer.


r12977 | chris | 2006-01-24 23:32:56 -0500 (Tue, 24 Jan 2006) | 5 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/report/report-gnome/report-gnome.scm
   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/doc.scm
   M /gnucash/trunk/src/scm/main.scm

   Re-enable report menu setup.
   The report menu setup is pretty fragile - it has to be done in a pretty
   specific order, so I pulled it out of (gnc:main) and call it independently.
   Also, move more bits of gnc:main into the modules where the bits are used.


r12976 | chris | 2006-01-24 21:06:08 -0500 (Tue, 24 Jan 2006) | 6 lines

   M /gnucash/trunk/src/app-utils/app-utils.scm
   M /gnucash/trunk/src/core-utils/gw-core-utils-spec.scm
   M /gnucash/trunk/src/engine/gw-engine-spec.scm
   M /gnucash/trunk/src/gnome-utils/gnc-menu-extensions.scm
   M /gnucash/trunk/src/gnome-utils/gnome-utils.scm
   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm

   Export debugging state from C to guile.
   Remove obsolete guile command line options.
   Remove guile setting of add-extension hooks that were apparently
   obsoleted by C code a while ago.
   Remove guile's access to application lifecycle function hooks.


r12975 | chris | 2006-01-24 20:36:28 -0500 (Tue, 24 Jan 2006) | 8 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/business/business-gnome/business-gnome.scm
   M /gnucash/trunk/src/gnome/gw-gnc-spec.scm
   M /gnucash/trunk/src/gnome/top-level.c
   M /gnucash/trunk/src/gnome/top-level.h
   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.c
   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.h
   M /gnucash/trunk/src/gnome-utils/gnc-splash.c
   M /gnucash/trunk/src/gnome-utils/gnc-splash.h
   M /gnucash/trunk/src/gnome-utils/gw-gnome-utils-spec.scm
   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm
   M /gnucash/trunk/src/scm/price-quotes.scm

   Consolidate application lifecycle functions into src/gnome-utils,
   leaving only the highest level of gui initialization in /gnome/top-level.c
   Process --loglevel command-line option from C.
   Move the running of the startup hook from guile to C.
   Distrubute bits of scheme from main.scm to the modules they're used in.
   Remove more obsoleted scheme.


r12974 | chris | 2006-01-24 20:21:28 -0500 (Tue, 24 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/core-utils/gnc-main.c
   M /gnucash/trunk/src/core-utils/gnc-main.h
   M /gnucash/trunk/src/gnome-utils/gnc-main-window.c

   Process --debug command-line option from C instead of guile.
   This re-enables the debugging "extensions" menu.


2006-01-24  Christian Stimming  <stimming@tuhh.de>

	* src/import-export/hbci/gnc-hbci-gettrans.h: Factor out importing
	functions that might be useful for mt940 importer.

	* src/import-export/hbci/gnc-hbci-transfer.c: Fix wrong amount
	sign.

2006-01-23  Derek Atkins  <derek@ihtfp.com>

	* src/engine/test/Makefile.am: add explicit libdep on libcore-utils.la

2006-01-23  Neil Williams <linux@codehelp.co.uk>

	* src/engine/Transaction.c : Let the backend
	work with splits without checking for the parent Trans
	* src/gnome/glade/chart-export.glade : glade-fixup change.
	* src/gnome/glade/merge.glade : Reviewed for QSF Import usage
	* src/gnome/druid-merge.c : Fix QSF import and merge, closes
	[Bug 327640]. r12961. 
	* src/gnome/druid-merge.h : Remove unneeded function.
	* src/gnome/druid-hierarchy.c : Expand on the error message,
	should it still be required.
	* configure.in : Increase QOF dependency to the next release
	to ensure compatibility.

2006-01-23  Neil Williams <linux@codehelp.co.uk>

	* lib/libqof/backend/file/qsf-backend.c : Prevent 
	bad time values from being passed to entity.
	* lib/libqof/qof/qof_book_merge.c : Fix merge 
	handling of QOF_TYPE_CHAR to use gchar instead of 
	casting	from a gchar*
	* lib/libqof/qof/qof_book_merge.h : Use gchar 
	consistently instead of mixing with char.

r12964 | chris | 2006-01-23 14:29:57 -0500 (Mon, 23 Jan 2006) | 5 lines

   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/gnucash-bin.c

  Avoid GUI initialization durring --add-price-quotes, fixes #327670

  BTW, it turns out that we don't need to call gtk_init().  It's called 
  during the LIBGNOMEUI_MODULE initializtion from gnome_program_init().

r12956 | chris | 2006-01-23 12:38:13 -0500 (Mon, 23 Jan 2006) | 28 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/gnome/Makefile.am
   M /gnucash/trunk/src/gnome/gw-gnc-spec.scm
   M /gnucash/trunk/src/gnome/top-level.c
   M /gnucash/trunk/src/gnome/top-level.h
   M /gnucash/trunk/src/scm/Makefile.am
   M /gnucash/trunk/src/scm/build-config.scm.in
   M /gnucash/trunk/src/scm/main-window.scm
   M /gnucash/trunk/src/scm/main.scm

  Major step in extraction of application startup from guile.

  Details:
    Remove the last bits of libguile from top-level.[ch].
    Change the gui initialization funtions so they can be called from C.
    Drop some gwrappers for gui initialization functions.
    Process the --nofile and filename command-line options from C.
    Drastic simpilification of main.scm.
    Initialize the gui and enter the gtk event-loop from C.

  Even though there's some more clean-up to do, this patch does mark
  a certain milestone:  A developer seeking to understand and/or modify 
  GnuCash's startup process can now essentially ignore the guile portion.
  Most parts of our startup now look pretty typical for a gnome-2 app.
  The parts that remain firmly in guile are initialization of the report
  menus and the installation of price-quote sources.

  Caveat: We have multiple mechanisms for handling the filename
  argument string -- some in guile and some in C.  The C-side mechanisms
  (in engine/gnc-filepath-utils.c) seem a little nicer than the guile
  ones (in main.scm).  They have slightly different behavior (e.g. which
  paths they'll search for data files.)  They both handle URIs and
  making absolute paths out of relative ones.  This patch switches from
  using the guile functions to the C function.  I've tested that the common
  cases are handled the same way, but it wouldn't surprise me if some 
  corner-cases are not.


r12948 | chris | 2006-01-22 22:56:10 -0500 (Sun, 22 Jan 2006) | 2 lines

   M /gnucash/trunk/src/scm/main.scm

  Remove "batch-mode" processing from main.scm.  It's no longer needed.

r12947 | chris | 2006-01-22 22:43:55 -0500 (Sun, 22 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm

  Remove --devel option, which aparently doesn't do anything.
  Also remove now unused guile portion of --add-price-quote option.

r12946 | chris | 2006-01-22 22:26:01 -0500 (Sun, 22 Jan 2006) | 18 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/main.scm
   M /gnucash/trunk/src/scm/price-quotes.scm

  Process the --add-price-quotes command-line option from C.
  This is done by booting guile with a custom inner_main.
  Much of the work is still handled by price-quotes.scm, which
  is now a true stand-alone guile module without the circular dependency
  on the (gnucash main) module.

  One caveat:  Since the initialization of guile-side debugging variables 
  is in main.scm, and since main.scm is no longer executed when running
  --add-price-quotes, the guile code that runs during --add-price-quote
  isn't affected by the --debug option.  A work-around is to use the 
  GNC_DEBUG environment variable: 
    $ GNC_DEBUG=yes gnucash --add-price-quote myfile

  In the longer term, we'll either move the debugging aids to a common place
  where it can be used by both main.scm and price-quotes.scm, or we'll get
  the debugging state from the C-side via gwrap.
 

r12945 | chris | 2006-01-22 22:12:27 -0500 (Sun, 22 Jan 2006) | 3 lines

   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.c
   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.h
   M /gnucash/trunk/src/gnome-utils/gw-gnome-utils-spec.scm

  Introduced gwrapped gnc_gnome_locate_data_file().=
  This was supposed to go with r12942.

r12944 | chris | 2006-01-22 19:47:45 -0500 (Sun, 22 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c

  Process gnome command-line arguments after our own, 
  so we can provide our own AUTOHELP.

r12943 | chris | 2006-01-22 19:46:22 -0500 (Sun, 22 Jan 2006) | 3 lines

   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm
   M /gnucash/trunk/src/scm/price-quotes.scm

  Remove processing of share-path from guile.
  This is now handled by Gnome's gnome_program_locate_file() function.

r12942 | chris | 2006-01-22 18:12:15 -0500 (Sun, 22 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/gnome/top-level.c
   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.c
   M /gnucash/trunk/src/gnome-utils/gnc-gnome-utils.h
   M /gnucash/trunk/src/gnome-utils/gw-gnome-utils-spec.scm

 Initialize Gnome libraries before booting guile.

2006-01-22  David Hampton  <hampton@employees.org>

	* src/gnome/dialog-chart-export.c:
	* src/gnome/glade/chart-export.glade: More HIG changes.

	* src/gnome-utils/gnc-file.c: Add an icon to the export button in
	the generic filename dialog.

	* src/gnome-utils/glade/commodity.glade:
	* src/gnome/dialog-price-editor.c:
	* src/gnome/glade/progress.glade:
	* src/gnome/glade/price.glade:
	* src/gnome/dialog-price-edit-db.c: More HIG changes.

	* src/scm/printing/print-check.scm:
	* src/gnome/glade/print.glade:
	* src/gnome/schemas/Makefile.am:
	* src/gnome/schemas/apps_gnucash_dialog_common.schemas.in:
	* src/gnome/schemas/apps_gnucash_dialog_print_checks.schemas.in:
	* src/gnome/dialog-print-check.[ch]: Overhaul the print check
	dialog.  Make HIG changes, and make the dialog remember its state
	across invocations (including all the custom values).  Fix a crash
	when canceling printing.

	* src/register/ledger-core/dialog-dup-trans.c:
	* src/gnome-utils/dialog-account.c:
	* src/gnome-utils/glade/commodity.glade:
	* src/gnome-utils/glade/exchange-dialog.glade:
	* src/gnome/dialog-totd.c:
	* src/gnome/glade/stocks.glade:
	* src/gnome/glade/budget.glade:
	* src/gnome/glade/totd.glade:
	* src/gnome/glade/register.glade:
	* src/gnome/glade/account.glade:
	* src/gnome/druid-stock-split.c: More HIG changes.

	* src/gnome-utils/gnc-date-edit.[ch]:
	* src/gnome-utils/gnc-general-select.[ch]: Add support for setting
	these widgets as the target of a GtkLabel access key.

2006-01-21  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-amount-edit.c:
	* src/gnome/dialog-fincalc.c:
	* src/gnome/glade/fincalc.glade: Overhaul the financial calculator
	dialog.

2006-01-21  Derek Atkins  <derek@ihtfp.com>

	* src/bin/gnucash-bin.c:  update splash screen while loading modules.
	  Granted, this has no effect because the splash screen isn't
	  /UP/ when we're loading the modules.  But still, once we
	  initialize the gnome application earlier this will let us
	  update the splash screen.

	* src/app-utils/prefs.scm: replace an API needed by old scheme
	  config files.  It was removed in r11565.  Replace it now.

	* src/backend/file/io-example-account.c
	* src/backend/file/sixtp-utils.c
	* src/backend/file/sixtp.c
	* src/calculation/expression_parser.c
	* src/gnome-utils/gnc-date-edit.c
	* src/gnome-utils/gnc-menu-extensions.c
	* src/app-utils/gnc-ui-util.h
	* src/app-utils/gnc-ui-util.c
	* doc/Makefile.am
	* lib/libqof/qof/guid.c
	* lib/libqof/qof/gnc-date.c
	* lib/libqof/qof/gnc-engine-util.c
	* lib/libqof/qof/gnc-engine-util.h
	  Thomas Klausner's NetBSD patch.

	* src/bin/test/Makefile.am:
	  Need to add a PATH for the tests to succeed.

2006-01-21  David Hampton  <hampton@employees.org>

	* src/gnome-utils/*.glade: Move glade files to a new subdirectory.

	* src/gnome-utils/commodity.glade:
	* src/gnome-utils/exchange-dialog.glade:
	* src/gnome-utils/druid-provider-multifile.glade:
	* src/gnome-utils/dialog-commodity.c: HIG rework.

	* src/business/business-gnome/glade/billterms.glade:
	* src/business/dialog-tax-table/dialog-tax-table.c:
	* src/business/dialog-tax-table/tax-tables.glade: HIG rework on a
	couple of dialogs.

	* src/import-export/qif-import/qif.glade:
	* src/import-export/binary-import/binary-import.glade:
	* src/import-export/import-provider-format.glade:
	* src/import-export/hbci/glade/hbci.glade: Do some HIG cleanup.
	Remove extraneous newline characters from strings.

2006-01-21  Christian Stimming  <stimming@tuhh.de>

	* src/import-export/hbci/glade/hbci.glade: Add field length limits
	again to avoid data loss on text entry. 

2006-01-20  David Hampton  <hampton@employees.org>

	* src/register/register-gnome/gnucash-item-list.c: Glib 2.9
	requires GdkEvents to be marked as BOXED instead of POINTER.
	Fixes #326056.

2006-01-20  Derek Atkins  <derek@ihtfp.com>

	* src/bin/gnucash-bin.c: Load config.auto AND config.user files.
	  Load the .user file first, and then load the .auto.
	* src/scm/Makefile.am:  paths.scm was removed.
	
r12912 | chris | 2006-01-20 22:59:22 -0500 (Fri, 20 Jan 2006) | 3 lines

   M /gnucash/trunk/src/app-utils/gw-app-utils-spec.scm
   M /gnucash/trunk/src/engine/gw-engine-spec.scm
   M /gnucash/trunk/src/report/report-system/html-style-sheet.scm
   M /gnucash/trunk/src/report/report-system/report.scm
   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm
   D /gnucash/trunk/src/scm/path.scm

  Guile-side clean-up for --namespace option.
  Also one bit of uncommitted code from gwrap change.

r12911 | chris | 2006-01-20 22:50:25 -0500 (Fri, 20 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/core-utils/Makefile.am
   A /gnucash/trunk/src/core-utils/gnc-main.c
   A /gnucash/trunk/src/core-utils/gnc-main.h
   M /gnucash/trunk/src/engine/Makefile.am
   M /gnucash/trunk/src/engine/gnc-commodity.c
   M /gnucash/trunk/src/engine/gnc-commodity.h
   M /gnucash/trunk/src/engine/gw-engine-spec.scm
   M /gnucash/trunk/src/scm/price-quotes.scm

  Process the --namespace command-line option from C, not guile.

r12910 | chris | 2006-01-20 09:52:57 -0500 (Fri, 20 Jan 2006) | 1 line

   M /gnucash/trunk/src/gnome-utils/test/Makefile.am

Fix linking for src/gnome-utils/test/

r12909 | chris | 2006-01-20 00:19:15 -0500 (Fri, 20 Jan 2006) | 5 lines

   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm
   M /gnucash/trunk/src/scm/path.scm

  Move the loading of user and system config files from guile to C.

  Remove the "load config" command line options, since they weren't doing 
  anything different than the default. 

r12902 | chris | 2006-01-19 13:43:59 -0500 (Thu, 19 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/gnome/top-level.h

  Remove "reverse_balance" fucntions from top-level.h.
  Add another #include for gnucash-bin.c

r12900 | chris | 2006-01-19 13:02:18 -0500 (Thu, 19 Jan 2006) | 4 lines

   M /gnucash/trunk/AUTHORS
   M /gnucash/trunk/src/engine/Account.c
   M /gnucash/trunk/src/engine/Account.h
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-account-types.c
   M /gnucash/trunk/src/gnome-utils/gnc-tree-model-account-types.h

  Filter out deprecated account types from the account types treemodel.

  Patch by Eskil Bylund <eskil.bylund@gmail.com>

r12899 | chris | 2006-01-19 12:58:02 -0500 (Thu, 19 Jan 2006) | 3 lines

   M /gnucash/trunk/src/app-utils/gncmod-app-utils.c
   M /gnucash/trunk/src/bin/gnucash-bin.c

  Add hooks just once in app_utils module init.  
  Also don't try to load imaginary module.

r12886 | chris | 2006-01-19 09:16:58 -0500 (Thu, 19 Jan 2006) | 2 lines

   M /gnucash/trunk/src/gnome/top-level.h

  add missing #include

r12882 | chris | 2006-01-19 00:54:16 -0500 (Thu, 19 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/main.scm

   Exit gnucash from C, not guile.

r12881 | chris | 2006-01-19 00:18:27 -0500 (Thu, 19 Jan 2006) | 2 lines

   M /gnucash/trunk/src/app-utils/app-utils.scm
   M /gnucash/trunk/src/app-utils/gncmod-app-utils.c

  move some app-util function hooks from guile to C

2006-01-19  David Hampton  <hampton@employees.org>

	* src/core-utils/gnc-gkeyfile-utils.[ch]:
	* src/app-utils/file-utils.c:
	* src/app-utils/gnc-exp-parser.c: Provide better arguments for
	specifying what to do when a key_file doesn't exist.

	* src/gnome-utils/gnc-main-window.c: Check for bogus window
	structures (i.e. empty) when reading/writing the state file.

2006-01-19  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-gnome/dialog-invoice.c:
	  need to #include gkeyfile.h for glib24 systems
	* src/business/business-gnome/Makefile.am:
	  link against glib26 compatibility library.

2006-01-19  David Hampton  <hampton@employees.org>

	* src/business/business-gnome/dialog-invoice.c: Delete the invoice
	page completely when closing it.  Prevents a crash when trying to
	open a different data file is there is an invoice page in the
	window.

	* src/gnome-search/gnc-general-search.c: Finish the job. Make sure
	this component isn't unregistered multiple times.

2006-01-18  Derek Atkins  <derek@ihtfp.com>

	* src/bin/gnucash-bin.c:
	* src/gnome-utils/gnc-splash.c:
	  Always print the SVN version and build date.
	  Make "development version" based on GNUCASH_SVN
	* src/gnome-utils/Makefile.am:
	  Define GNUCASH_SVN whenever the source is not a dist tarball.

2006-01-18  David Hampton  <hampton@employees.org>

	* src/business/business-core/gncOwner.[ch]:
	* src/business/business-gnome/dialog-invoice.[ch]:
	* src/business/business-gnome/gnc-plugin-page-invoice.c:
	Save/restore business invoice pages.

	* src/app-utils/gnc-component-manager.c: Tweak a debugging
	statement.

	* src/gnome-search/gnc-general-search.c: Unregister this component
	properly when destroying it.

	* src/gnome-utils/gnc-query-list.c: The GtkObject destroy function
	can be called multiple times. Protect from unregistering the
	component multiple times.

2006-01-18  Joshua Sled  <jsled@asynchronous.org>

	* src/app-utils/gnc-account-merge.[ch]: C-style comment
	conventions; rename identifiers that are C++ keywords.

2006-01-18  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/gnc-plugin-page-account-tree.c
	(gnc_plugin_page_account_tree_create_widget): Remove name-editing
	callback setup.

2006-01-18  David Hampton  <hampton@employees.org>

	* All xxx.schemas files renamed to xxx.schemas.in.
	* All schema directory Makefile.am files replaced.
	* make-gnucash-potfiles.in: Now also pulls strings from schema
	files.  Together these fix bugs #327507 and #327353 which are
	about schema file strings not being translated.

2006-01-18  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/dialog-sx-from-trans.c (sxftd_update_fs): Propgate
	bi-weekly ui-frequency in transition from "schedule transaction"
	dialog to "Advanced..." (Scheduled Transaction Editor).
	Patch from Robert Zaleski <rzaleski81@yahoo.com>.
	<http://bugzilla.gnome.org/show_bug.cgi?id=327547>.

2006-01-18  Derek Atkins  <derek@ihtfp.com>

	* src/bin/Makefile.am:  Fix some srcdir/builddir issues
	  with #includes and libraries.
	* src/Makefile.am:  Move 'bin' last so that it's built
	  after gnome-utils so Chris' change works.

r12879 | chris | 2006-01-18 23:29:07 -0500 (Wed, 18 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm

  Move "unstable development version" message from guile to C.
  Remove crufty guile command-line options.

r12874 | chris | 2006-01-18 21:34:23 -0500 (Wed, 18 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/main.scm

  dlopen() modules from C, instead of from guile

r12873 | chris | 2006-01-18 21:00:25 -0500 (Wed, 18 Jan 2006) | 2 lines

   M /gnucash/trunk/src/scm/main.scm

  The Parenthesis!  My favorite punctuation.

r12872 | chris | 2006-01-18 20:33:16 -0500 (Wed, 18 Jan 2006) | 4 lines

   M /gnucash/trunk/src/scm/command-line.scm
   M /gnucash/trunk/src/scm/main.scm
   M /gnucash/trunk/src/scm/path.scm

  Minor scheme cleanup.
  Move one function from path.scm to command-line.scm.
  Remove processing of arguments now handled in C.

r12868 | chris | 2006-01-18 20:26:21 -0500 (Wed, 18 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c

  Use popt to automatically generate pretty --usage and --help.

r12838 | chris | 2006-01-17 22:46:53 -0500 (Tue, 17 Jan 2006) | 3 lines

   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/gnucash-bin.c

  Catch --version argument before booting Guile.
  Also show svn revision info if binary was built from svn.

2006-01-17  Christian Stimming  <stimming@tuhh.de>

	* src/import-export/mt940/gnc-mt940-import.c: Add initial work on
	upgrading the old non-compilable mt940-importer code by
	F. Steinel. Code still non-compilable, see
	http://bugzilla.gnome.org/show_bug.cgi?id=325170

2006-01-17  Neil Williams <linux@codehelp.co.uk>

	* src/engine/gnc-engine.c : Removing .la from
	name of module to be loaded with GModule.

r12817 | chris | 2006-01-16 21:28:13 -0500 (Mon, 16 Jan 2006) | 2 lines

   M /gnucash/trunk/src/engine/test/test-lots.c

  sane indenting

r12816 | chris | 2006-01-16 21:26:16 -0500 (Mon, 16 Jan 2006) | 12 lines

   M /gnucash/trunk/src/bin/gnucash-bin.c
   M /gnucash/trunk/src/scm/main.scm

  Pull the C inner_main into the environment of the guile (gnucash
  main) module.

  Strangely, symbols that are resolved during a dlopen() *before* calling 
  scm_set_current_module() are not resolvable from guile code that is inside 
  a module. 

  In order for code in a guile module to see symbols from dlopen'ed libraries,
  they must be dlopen'ed *while* that guile module is current.  I imagine this
  is because the process of changing the current guile module purposely hides 
  all symbols in the current symbol table - to create an illusion of an empty
  table.  Kinda interesting... kinda scary...

r12815 | chris | 2006-01-16 20:42:46 -0500 (Mon, 16 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/overrides/Makefile.am

  Don't distribute non-existant 'gnucash'

r12372 | chris | 2006-01-16 16:17:48 -0500 (Mon, 16 Jan 2006) | 2 lines

   M /gnucash/trunk/GNOME2_STATUS

   update budget-related status

r12368 | chris | 2006-01-16 11:30:12 -0500 (Mon, 16 Jan 2006) | 5 lines

   M /gnucash/trunk/src/gnc-module/gnc-module.c
   M /gnucash/trunk/src/gnc-module/gnc-module.h
   M /gnucash/trunk/src/gnc-module/gnc-module.scm
   M /gnucash/trunk/src/gnc-module/gw-gnc-module-spec.scm
   M /gnucash/trunk/src/gnc-module/test/test-load-c.c

  Slight contraction of gnc-module API.

  Privatize structures that aren't used externally.  Remove unused functions. 

r12367 | chris | 2006-01-16 09:42:43 -0500 (Mon, 16 Jan 2006) | 2 lines

   M /gnucash/trunk/src/business/business-core/test/test-customer.c

  Register business objects before testing them.

r12366 | chris | 2006-01-16 09:24:57 -0500 (Mon, 16 Jan 2006) | 2 lines

   M /gnucash/trunk/lib/libgsf-1.12.3/tests/test-cp-zip.c

  Allow a libgsf test to pass even with glib 2.4.

r12365 | chris | 2006-01-16 00:30:34 -0500 (Mon, 16 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/test/Makefile.am

  Remove unneeded testing environments.

r12364 | chris | 2006-01-16 00:22:01 -0500 (Mon, 16 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/test/Makefile.am
   D /gnucash/trunk/src/bin/test/fake-guile
   D /gnucash/trunk/src/bin/test/test-guile-env-override

  Remove obsolete test for starting GnuCash with a different guile.


2006-01-16  Joshua Sled  <jsled@asynchronous.org>

	* lib/libgsf-1.12.3/thumbnailer/
	* lib/libgsf-1.12.3/Makefile.am: Remove unused 'thumbnailer'
	directory.

2006-01-16  Joshua Sled  <jsled@asynchronous.org>

	* src/register/register-gnome/gnucash-sheet.c
	(GTK_ALLOWED_SELECTION_WITHIN_INSERT_SIGNAL): Compatibility with
	gtk 2.8, as well, for selection of the auto-completed region.

2006-01-16  Derek Atkins <derek@ihtfp.com>

	* configure.in: us AM_PATH_GWRAP properly. Exit configure on failure.

2006-01-15  Derek Atkins  <derek@ihtfp.com>

	* src/gnome/dialog-new-user.c: some fixes to get file to compile.

2006-01-15  Joshua Sled  <jsled@asynchronous.org>

	* accounts/C/*: add placeholder flags for relevant accounts.
	
2006-01-15  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome-utils/gnc-tree-view-account.c
	(gnc_tree_view_account_new_with_group):
	Record editable text columns in private data structure.
	(gtva_set_column_editor)
	(gtva_setup_column_renderer_edited_cb) 
	(gnc_tree_view_account_set_name_edited) 
	(gnc_tree_view_account_set_code_edited) 
	(gnc_tree_view_account_set_description_edited) 
	(gnc_tree_view_account_set_notes_edited):
	Add support for setting up column-edited callbacks.
	(gnc_tree_view_account_name_edited_cb) 
	(gnc_tree_view_account_code_edited_cb) 
	(gnc_tree_view_account_description_edited_cb) 
	(gnc_tree_view_account_notes_edited_cb):
	Provide stock editable-column handlers.

	* src/gnome/gnc-plugin-page-account-tree.c
	(gnc_plugin_page_account_tree_create_widget): Setup default
	editing callbacks for text columns.

	* src/app-utils/gnc-account-merge.[ch]: Non-ui-specific utility
	routines from account-hierarchy druid regarding account-hierarchy
	merge logic and constraints.

	* src/gnome/druid-hierarchy.c: Remove static variables describing
	dialog and dialog-in-interaction-with the druid-merge.c code.
	(gnc_create_hierarchy_druid, get_final_balance)
	(set_final_balance): simplify to Map<Account*,
	balance:gnc_numeric*>, which is more tolerant of Account-name
	changes.
	(gnc_ui_hierarchy_druid_with_callback): Add callback support for
	caller to have calling-specific work done.
	(use_existing_account_data_func): Conditionally add column
	detailing the status of how this new hierarchy merges into the
	existing one.
	(on_final_account_next): Check to ensure there are no
	account-hierarchy merge conflicts before allowing Next to final
	page.
	(balance_cell_data_func): Add new subtlety around opening-balance
	editing in the face of hierarachy-merging.
	(on_finish): Reorder dialog finishing to work around account-tree
	model bug, starting-balance-transaction creation, data-merging,
	when-completed callback creation.
	(gnc_ui_hierarchy_druid_hook): Add callback to create new
	account-page as consequence of new-file hook run.

	* src/gnome/dialog-new-user.c (after_hierarchy_druid): Create+use
	callback for new-user-dialog specific code.

	* src/gnome/glade/account.glade: Change "opening balances" page
	title, default dialog positioning hint (from none to parent-center).

	* src/gnome/druid-merge.[ch]
	(gnc_ui_qof_book_merge_druid): Remove hierarchy-druid wrapper.
	: remove un-used qof_book_merge_druid.

	* accounts/C/*: Add placeholder flag on relevant accounts.

r12363 | chris | 2006-01-15 22:23:35 -0500 (Sun, 15 Jan 2006) | 2 lines

   M /gnucash/trunk/src/bin/test/test-version

  Fix src/bin/test/test-version for new gnucash executable.

r12362 | chris | 2006-01-15 21:43:56 -0500 (Sun, 15 Jan 2006) | 6 lines

   M /gnucash/trunk/lib/libqof/backend/file/Makefile.am

   Specify that LIBADD libraries are for libqof_backend_qsf.la.
   Solves:
      libqof-backend-qsf.so: undefined symbol: xmlNodeGetContent

      error during `make check'

r12351 | chris | 2006-01-14 00:47:17 -0500 (Sat, 14 Jan 2006) | 5 lines

   M /gnucash/trunk/src/business/dialog-tax-table/Makefile.am

   Declare library dependency for dialog-tax-table.

   libtool 1.5.16 seems to not mind the dependency being undeclared but
   libtool 1.5.6 on FC3 won't lt_dlopen() the .la file without it.

r12350 | chris | 2006-01-13 22:56:53 -0500 (Fri, 13 Jan 2006) | 4 lines

   M /gnucash/trunk/configure.in
   M /gnucash/trunk/doc/Makefile.am
   M /gnucash/trunk/lib/libc/Makefile.am
   M /gnucash/trunk/lib/libqof/backend/file/Makefile.am
   M /gnucash/trunk/src/bin/Makefile.am
   M /gnucash/trunk/src/bin/overrides/Makefile.am
   M /gnucash/trunk/src/gnome/Makefile.am
   M /gnucash/trunk/src/gnome-utils/Makefile.am
   M /gnucash/trunk/src/quotes/Makefile.am

  Add 'Makefile' as a dependency for targets that are generated
  from scriptlets in Makefile.  That way, if the generating scriptlet is
  changed, (or the Makefile is regenerated) the target will also be remade.

r12339 | chris | 2006-01-13 00:13:05 -0500 (Fri, 13 Jan 2006) | 2 lines

   M /gnucash/trunk/Makefile.am
   M /gnucash/trunk/configure.in
   M /gnucash/trunk/lib/libqof/qof/Makefile.am
   M /gnucash/trunk/src/Makefile.am
   M /gnucash/trunk/src/bin/Makefile.am

  Various fixes to allow `make dist` and building from tarball.

2006-01-13  Derek Atkins  <derek@ihtfp.com>

	* src/gnome-utils/Makefile.am: revert 12296 and handle the
	  case of an svn checkout without .svn subdirs (gentoo ebuild).
	  In particular, we want to use $(srcdir)/gnc-svninfo.h
	  so that a build from a dist tarball has the svn version.

	* src/bin/overrides/gnucash
	* src/bin/overrides/gnucash-valgrind
	* src/bin/overrides/Makefile.am:
	  remove unnecessary override files that are no longer useful.

	* goffice/*/Makefile.am:
	* libgsf/*/Makefile.am:
	  don't install goffice and gsf headers.

	* configure.in: Properly set QOF_LIB_DIR et. al. for internal qof.

	* lib/libqof/qof/Makefile.am: qofla-dir.h depends on Makefile.
	  Make sure you rebuild qofla-dir.h when the Makefile changes,
	  which would imply re-configuration.  You never know, the
	  user might have changed --prefix which means you want to
	  rebuild the header.

2006-01-13  Neil Williams <linux@codehelp.co.uk>

	* src/bin/test/test-version : Using Derek's fix to
	resolve the test failure.

2006-01-13  Derek Atkins  <derek@ihtfp.com>

	* src/bin/overrides/gnucash-build-env.in:
	  Change core-utils to a gnc-module-dir so it loads both
	  the .scm and the .so properly.

r12338 | chris | 2006-01-12 21:05:51 -0500 (Thu, 12 Jan 2006) | 10 lines

   M /gnucash/trunk/ChangeLog
   M /gnucash/trunk/ChangeLog.2005

  ChangeLog entries from svn for past 12 days.

  Hmm... A commit message for my commit messages... what to write?
  Using this, format which is much closer to svn log, saved some time.  
  This commit took about 10 min to prepare, and I estimate it would have 
  taken another 20 to format like my last entries.  The main effort is 
  moving the messages off of column 0.  I suspect that the non-uniform 
  entry style might start to bother me enough to look at the xslt again.  
  We'll see.

r12337 | chris | 2006-01-12 20:25:12 -0500 (Thu, 12 Jan 2006) | 5 lines

   M /trunk/src/app-utils/Makefile.am
   M /trunk/src/app-utils/gnc-gettext-util.c
   M /trunk/src/app-utils/gnc-gettext-util.h
   M /trunk/src/app-utils/gw-app-utils-spec.scm
   D /trunk/src/app-utils/i18n.h.in
   M /trunk/src/bin/Makefile.am
   M /trunk/src/bin/gnucash-bin.c
   A /trunk/src/bin/i18n.h.in (from /trunk/src/app-utils/i18n.h.in:12334)
   M /trunk/src/scm/main.scm

   Move gnu-module init and gettext init from scm to C.
   Move i18n.h.in from src/app-utils to src/bin, where it is used.
   Remove unneeded gettext init code in src/app-utils

r12330 | chris | 2006-01-12 16:26:01 -0500 (Thu, 12 Jan 2006) | 6 lines

   M /trunk/src/backend/file/gnc-account-xml-v2.c
   M /trunk/src/backend/file/test/test-real-data.sh
   M /trunk/src/backend/file/test/test-xml-account.c

   Don't let deprecated tags overwrite data from newer tags.
   Avoid testing for match of deprecated tags.
   Warn about deprecated tags not being preserved.
   Plug another leak in test case.
   Make successful test-xml-account less verbose.

r12329 | chris | 2006-01-12 16:22:03 -0500 (Thu, 12 Jan 2006) | 3 lines

   M /trunk/src/backend/file/test/test-file-stuff.c

   Avoid creating new xml parser for each test file.
   This plugs a mem leak in the test case.

2006-01-12  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-tree-view-account.c: Remove the unnecessary
	explicit removal of the tree model and let the core GtkTreeView
	code do its thing.  Prevents a weird crash when canceling the
	transfer code.

2006-01-12  Derek Atkins  <derek@ihtfp.com>

	* configure.in:  add --enable-qof so build defaults to internal qof.

	* configure.in: fixes to make configure more quiet
	  - move PKG_CONFIG check early in the process
	  - use --silence-errors more
	* macros/pkg.m4: work around a pkg-config bug that outputs
	  errors to stderr even when you tell it to output to stdout.

2006-01-10  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-gnome-utils.c:
	* src/gnome-utils/dialog-utils.c: A couple of simple substitutions
	for deprecated functions.

	* src/gnome-utils/dialog-options.c: Use newer function for setting
	the width of a GtkSpinButton.

	* src/network-utils/Makefile.am:
	* src/gnome-utils/gnc-html.c:
	* src/gnome/top-level.c: The gnucash gpg networking code isn't
	called from anywhere.  No need to compile it as part of the build.

	* src/register/register-gnome/gnucash-cursor.c:
	* src/register/register-gnome/gnucash-item-edit.c:
	* src/register/register-gnome/gnucash-grid.c:
	* src/register/register-gnome/gnucash-header.c:
	* src/gnome-utils/gnc-dense-cal.c:
	* src/gnome-utils/gnc-main-window.c:
	* src/gnome-utils/dialog-utils.c:
	* src/gnome-utils/dialog-options.c: Replace deprecated functions
	with their current equivalent.

2006-01-10  Derek Atkins  <derek@ihtfp.com>

	* make-gnucash-potfiles.in: ignore dangling symlinks when
	  building po/POTFILES.in

2006-01-10  Christian Stimming  <stimming@tuhh.de>

	* accounts/nb/*, configure.in: Add account templates for Norwegian
	(Bokmal) language; by Tor Harald Thorland <linux@strigen.com>; not
	fully functional so far.

r12322 | chris | 2006-01-10 23:39:12 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/Account.c

   Factor-out cut-n-paste job from xaccCloneAccount{Simple}.

r12321 | chris | 2006-01-10 23:30:20 -0500 (Tue, 10 Jan 2006) | 3 lines

   M /trunk/src/engine/Account.c

   Convert account name, code and description to use string cache.
   Plus minor comments and tweaks.

r12319 | chris | 2006-01-10 23:27:02 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/lib/libqof/qof/gnc-engine-util.h

   Add CACHE_REPLACE(dst, src) macro for common case in string setters.

r12316 | chris | 2006-01-10 21:58:59 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/gnc-commodity.c

   Convert gnc-commodity to use vanilla string cache macros.

r12315 | chris | 2006-01-10 21:56:02 -0500 (Tue, 10 Jan 2006) | 3 lines

   M /trunk/lib/libqof/qof/gnc-engine-util.c
   M /trunk/lib/libqof/qof/gnc-engine-util.h

   Add const to gnc_string_cache_insert argument.
   Handle NULL values gracefully.

r12313 | chris | 2006-01-10 21:19:42 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/test/test-date.c

   Add commented-out test case demonstrating lack of year 2038 support.

r12311 | chris | 2006-01-10 16:42:55 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/gnc-commodity.c

   Plug memory leak of gnc_commodity_namespace->QofInstance; found w/ valgrind.

r12308 | chris | 2006-01-09 16:06:45 -0500 (Mon, 09 Jan 2006) | 2 lines

   M /trunk/src/engine/test/test-date.c

   Avoid testing dates near or after 2038, because the qof parsing
   functions fail.

r12306 | chris | 2006-01-08 22:33:46 -0500 (Sun, 08 Jan 2006) | 2 lines

   M /trunk/src/app-utils/gnc-ui-util.c
   M /trunk/src/app-utils/test/test-print-parse-amount.c

   Don't test numeric parsing for numbers that overflow, we'd fail.

2006-01-08  David Hampton  <hampton@employees.org>

	* src/gnome-utils/dialog-options.c: Add a button to clear the name
	of the currently selected file in a file chooser.

	* src/register/register-gnome/gnucash-item-list.c:
	* src/import-export/hbci/dialog-hbcitrans.c: The GTK2.4 headers
	are missing a named constant.

	* lib/goffice-0.0.4/goffice/glib24_26-compat.c: Fix a couple of
	compiler version issues.

2006-01-08  Derek Atkins  <derek@ihtfp.com>

	* Makefile.am: fix the dist-hook macro for po/POTFILES.in

2006-01-08  Neil Williams <linux@codehelp.co.uk>

	* src/import-export/qif-import/test/Makefile.am : OSX fix.
	* po/en_GB.po : (To assist the TP project,
	with help from Nigel Titley, GNU translator.)
	Remaining: 92 fuzzy translations, 1 untranslated message
	* . : Adding *.prj.bak to svn:ignore.

2006-01-08  Neil Williams <linux@codehelp.co.uk>

	* src/engine/Transaction.c : Even up ENTER and LEAVE
	calls.
	* src/gnome-utils/druid-gconf-setup.c : Typo fix.
	* src/gnome-utils/gnc-tree-model-budget.h : Doxygen tweak.
	* src/gnome/gnc-plugin-budget.c : Match ENTER with LEAVE
	* src/gnome/gnc-plugin-page-budget.h : Doxygen tweak.

2006-01-08  Christian Stimming  <stimming@tuhh.de>

	* src/gnome-utils/gnc-main-window.c: Add gnc workaround function
	for errorneous gtk_action_group_set_translation_domain. Fixes the
	statusbar-tooltip error mentioned on 2006-01-07. Filed in gtk as
	bug#326200.

2006-01-07  David Hampton  <hampton@employees.org>

	* src/report/standard-reports/account-summary.scm: Copy the table
	markup from an intermediate table to the final displayed table.
	
	* src/report/report-system/html-acct-table.scm: When building a
	html table from an account tree, apply markup to the "total" lines
	so that they use the right stylesheet colors.

	* src/report/standard-reports/portfolio.scm:
	* src/report/standard-reports/advanced-portfolio.scm: Fix the
	"share decimal places" option.

2006-01-07  Christian Stimming  <stimming@tuhh.de>

	* src/gnome/gnc-plugin-page-register.c,
	src/report/report-gnome/gnc-plugin-page-report.c: Add more
	tooltips to actions.

	* src/gnome-utils/gnc-main-window.c: Add display of a GtkAction's
	tooltip in the statusbar when the mouse is selection its menu
	item. Code copied from gtk+'s test/testmerge.c. Works fine, except
	that in non-C locales some "" tooltips are translated in a weird
	way. Maybe because "" is errorneously passed through gettext(),
	which will accidentally catch a wrong string from the po
	files. This needs to be fixed.

	* src/report/report-gnome/gnc-plugin-page-report.c: Rename "Save
	report" menu item to "Add report" according to IRC discussion with
	warlord.
	
	* autogen.sh: Move code from macros/autogen.sh to here to make it
	more obvious what happens. Add checks for all programs that are
	called, fixes bug#325721. However in principle the code wasn't
	changed, only cleaned up.

2006-01-07  David Hampton  <hampton@employees.org>

	* src/business/business-gnome/dialog-order.c:
	* src/business/business-gnome/dialog-date-close.c:
	* src/gnome-utils/gnc-druid-provider-file-gnome.[ch]: Remove some
	deprecated gnome functions.

	* src/bin/gnucash-valgrind.in:
	* src/bin/Makefile.am: Add a script to invoke the new gnucash.bin
	executable via valgrind.

	* src/gnome/window-main-summarybar.c: Performance enhancements.
	Remove the model from the combo box before clearing and
	repopulating it.

2006-01-06  David Hampton  <hampton@employees.org>

	* src/import-export/hbci/dialog-hbcitrans.[ch]: 
	* src/import-export/hbci/glade/hbci.glade:
	* src/import-export/hbci/gnc-hbci-transfer.c: Make the HBCI
	Transfer dialog work again using a GtkListStore.

r12278 | chris | 2006-01-06 17:28:38 -0500 (Fri, 06 Jan 2006) | 2 lines

   M /trunk/src/app-utils/gnc-ui-util.c
   M /trunk/src/app-utils/gnc-ui-util.h

   Fix floating point exception by checking for overflow.

r12273 | chris | 2006-01-06 16:31:22 -0500 (Fri, 06 Jan 2006) | 10 lines

   M /trunk/Makefile.am

   Fixes for `make check' in toplevel Makefile.am.

   Conditionally add symlink from ./gsf to ./lib/libgsf-1.12.3/gsf.

   Also, silence warning:
     /usr/share/automake-1.9/am/tags.am: ctags was already defined in
     condition !GNC_CTAGS_FILE, which is included in condition TRUE ...
     Makefile.am:138: ... `ctags' previously defined here

   and avoid possible `make dist' failure by added po/POTFILES.in to
   dist-hook.

r12271 | chris | 2006-01-05 21:49:27 -0500 (Thu, 05 Jan 2006) | 8 lines

   M /trunk/Makefile.am
   D /trunk/po/POTFILES.in

   Yet more build tweaks for .pot file generation.

   Remove po/POTFILES.in (again) from svn.  Since po/POTFILES.in is added
   to BUILT_SOURCES, it's auto-generated now whenever the `make all',
   `make check', or `make install' targets are processed, (but not
   recreated every time).  And `make pot' forces the recreation of
   po/POTFILES.in.  Hopefully, this will works even on OSX.

2006-01-04  David Hampton  <hampton@employees.org>

	* src/gnome-utils/ui/gnc-main-window-ui.xml:
	* src/gnome-utils/gnc-main-window.c: Add in some conditionally
	compiled hooks for turning callgrind on/off via the menus.

	* src/gnome/gnc-plugin-page-account-tree.c: Consolidate some
	common functionality.

	* src/register/register-gnome/combocell-gnome.c:
	* src/register/register-gnome/gnucash-item-list.[ch]:
	* src/register/ledger-core/split-register-load.c:
	* src/register/register-core/combocell.h: Load the entire data set
	into the combocell before enabling sorting.  Saves a tremendous
	amount of time.
	
	* src/backend/file/gnc-transaction-xml-v2.c:
	* lib/libqof/qof/gnc-numeric.c: A couple of performance tweaks.

r12252 | chris | 2006-01-03 18:49:39 -0500 (Tue, 03 Jan 2006) | 5 lines

   M /trunk/src/bin/Makefile.am
   A /trunk/src/bin/gnucash-bin.c
   A /trunk/src/bin/gnucash.in

   Invert the program entry point.

   'gnucash' is now a shell script that calls the executable
   'gnucash-bin' which uses libguile to load guile modules.

2006-01-03  Joshua Sled  <jsled@asynchronous.org>

	* gnc-sxed-window-ui.xml: Remove unreferenced `TransactionAction`.

	* dialog-sxsincelast.c (sxsld_disposition_changed): change the
	assertion into a simple return-if-fail due to apparent change in
	the calling order in gtk 2.x...

2006-01-03  David Hampton  <hampton@employees.org>

	* src/engine/Transaction.c: When setting the amount of a split,
	don't call gnc_numeric_convert on it if the split isn't assigned
	to an account. This reduces the time spent loading a data file.

	* src/business/business-gnome/glade/invoice.glade: Couple the
	radio buttons in the unpost dialog.

	* src/gnome/top-level.c:
	* src/gnome/dialog-totd.c:
	* src/gnome/glade/totd.glade: Revert the previous change and make
	the totd always float above all other GnuCash windows.

2006-01-02  David Hampton  <hampton@employees.org>

	* src/gnome/dialog-totd.c: Use the component manager to ensure
	there is only one totd dialog at a time.  Don't mark the dialog as
	transient (or type GTK_WINDOW_DIALOG) so that window managers
	won't make it float above all other GnuCash windows.

	* src/engine/Transaction.c: Fix test inverted by commit 12231.

	* src/gnome-utils/Makefile.am
	* src/gnome-utils/gnc-tree-model-example-account.[ch]: Remove
	unused files.

	* src/gnome/glade/account.glade:
	* src/gnome/druid-hierarchy.c: Use a GtkListStore for the example
	account categories instead of layering a custom selection model on
	a custom example account model.  The code is a lot simpler and has
	additional sorting capability. Do some rework on the druid
	layout.

	* src/gnome-utils/gnc-tree-model-selection.[ch]: Correct function
	name.  Add a comment.

2006-01-02  Derek Atkine  <derek@ihtfp.com>

	* src/gnome-utils/gnc-tree-view-account.c:
	* src/gnome/gnc-plugin-page-budget.c:
	  need to #include gkeyfile.h if we don't have glib26.

2006-01-02  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-tree-view.c: Use the right function to hide
	a tree column. Update a couple of debugging messages.

	* src/engine/gw-engine-spec.scm:
	* src/engine/gnc-commodity.[ch]: Initialize the qof instances in
	commodity namespaces.

r12232 | chris | 2006-01-01 19:37:02 -0500 (Sun, 01 Jan 2006) | 2 lines

   D /trunk/src/gnome/gncmod-budget.c

   Delete unused gncmod-budget.c.

r12231 | chris | 2006-01-01 17:26:15 -0500 (Sun, 01 Jan 2006) | 9 lines

   M /trunk/src/engine/Transaction.c
   M /trunk/src/engine/Transaction.h

  General clean-up in Transaction.[ch].

    * Regularization of 'trans' as variable name.
    * Whitespace and linewraps
    * lots of control-flow simplification
    * factor one chunk out into get_any_account()
    * Comment some things that are bogus or need improvement
