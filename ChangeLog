2006-01-19  Derek Atkins  <derek@ihtfp.com>

	* src/business/business-gnome/dialog-invoice.c:
	  need to #include gkeyfile.h for glib24 systems
	* src/business/business-gnome/Makefile.am:
	  link against glib26 compatibility library.

2006-01-19  David Hampton  <hampton@employees.org>

	* src/business/business-gnome/dialog-invoice.c: Delete the invoice
	page completely when closing it.  Prevents a crash when trying to
	open a different data file is there is an invoice page in the
	window.

	* src/gnome-search/gnc-general-search.c: Finish the job. Make sure
	this component isn't unregistered multiple times.

2006-01-18  Derek Atkins  <derek@ihtfp.com>

	* src/bin/gnucash-bin.c:
	* src/gnome-utils/gnc-splash.c:
	  Always print the SVN version and build date.
	  Make "development version" based on GNUCASH_SVN
	* src/gnome-utils/Makefile.am:
	  Define GNUCASH_SVN whenever the source is not a dist tarball.

2006-01-18  David Hampton  <hampton@employees.org>

	* src/business/business-core/gncOwner.[ch]:
	* src/business/business-gnome/dialog-invoice.[ch]:
	* src/business/business-gnome/gnc-plugin-page-invoice.c:
	Save/restore business invoice pages.

	* src/app-utils/gnc-component-manager.c: Tweak a debugging
	statement.

	* src/gnome-search/gnc-general-search.c: Unregister this component
	properly when destroying it.

	* src/gnome-utils/gnc-query-list.c: The GtkObject destroy function
	can be called multiple times. Protect from unregistering the
	component multiple times.

2006-01-18  Joshua Sled  <jsled@asynchronous.org>

	* src/app-utils/gnc-account-merge.[ch]: C-style comment
	conventions; rename identifiers that are C++ keywords.

2006-01-18  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/gnc-plugin-page-account-tree.c
	(gnc_plugin_page_account_tree_create_widget): Remove name-editing
	callback setup.

2006-01-18  David Hampton  <hampton@employees.org>

	* All xxx.schemas files renamed to xxx.schemas.in.
	* All schema directory Makefile.am files replaced.
	* make-gnucash-potfiles.in: Now also pulls strings from schema
	files.  Together these fix bugs #327507 and #327353 which are
	about schema file strings not being translated.

2006-01-18  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome/dialog-sx-from-trans.c (sxftd_update_fs): Propgate
	bi-weekly ui-frequency in transition from "schedule transaction"
	dialog to "Advanced..." (Scheduled Transaction Editor).
	Patch from Robert Zaleski <rzaleski81@yahoo.com>.
	<http://bugzilla.gnome.org/show_bug.cgi?id=327547>.

2006-01-18  Derek Atkins  <derek@ihtfp.com>

	* src/bin/Makefile.am:  Fix some srcdir/builddir issues
	  with #includes and libraries.
	* src/Makefile.am:  Move 'bin' last so that it's built
	  after gnome-utils so Chris' change works.

2006-01-17  Christian Stimming  <stimming@tuhh.de>

	* src/import-export/mt940/gnc-mt940-import.c: Add initial work on
	upgrading the old non-compilable mt940-importer code by
	F. Steinel. Code still non-compilable, see
	http://bugzilla.gnome.org/show_bug.cgi?id=325170

2006-01-17  Neil Williams <linux@codehelp.co.uk>

	* src/engine/gnc-engine.c : Removing .la from
	name of module to be loaded with GModule.

2006-01-16  Joshua Sled  <jsled@asynchronous.org>

	* lib/libgsf-1.12.3/thumbnailer/
	* lib/libgsf-1.12.3/Makefile.am: Remove unused 'thumbnailer'
	directory.

2006-01-16  Joshua Sled  <jsled@asynchronous.org>

	* src/register/register-gnome/gnucash-sheet.c
	(GTK_ALLOWED_SELECTION_WITHIN_INSERT_SIGNAL): Compatibility with
	gtk 2.8, as well, for selection of the auto-completed region.

2006-01-16  Derek Atkins <derek@ihtfp.com>

	* configure.in: us AM_PATH_GWRAP properly. Exit configure on failure.

2006-01-15  Derek Atkins  <derek@ihtfp.com>

	* src/gnome/dialog-new-user.c: some fixes to get file to compile.

2006-01-15  Joshua Sled  <jsled@asynchronous.org>

	* accounts/C/*: add placeholder flags for relevant accounts.
	
2006-01-15  Joshua Sled  <jsled@asynchronous.org>

	* src/gnome-utils/gnc-tree-view-account.c
	(gnc_tree_view_account_new_with_group):
	Record editable text columns in private data structure.
	(gtva_set_column_editor)
	(gtva_setup_column_renderer_edited_cb) 
	(gnc_tree_view_account_set_name_edited) 
	(gnc_tree_view_account_set_code_edited) 
	(gnc_tree_view_account_set_description_edited) 
	(gnc_tree_view_account_set_notes_edited):
	Add support for setting up column-edited callbacks.
	(gnc_tree_view_account_name_edited_cb) 
	(gnc_tree_view_account_code_edited_cb) 
	(gnc_tree_view_account_description_edited_cb) 
	(gnc_tree_view_account_notes_edited_cb):
	Provide stock editable-column handlers.

	* src/gnome/gnc-plugin-page-account-tree.c
	(gnc_plugin_page_account_tree_create_widget): Setup default
	editing callbacks for text columns.

	* src/app-utils/gnc-account-merge.[ch]: Non-ui-specific utility
	routines from account-hierarchy druid regarding account-hierarchy
	merge logic and constraints.

	* src/gnome/druid-hierarchy.c: Remove static variables describing
	dialog and dialog-in-interaction-with the druid-merge.c code.
	(gnc_create_hierarchy_druid, get_final_balance)
	(set_final_balance): simplify to Map<Account*,
	balance:gnc_numeric*>, which is more tolerant of Account-name
	changes.
	(gnc_ui_hierarchy_druid_with_callback): Add callback support for
	caller to have calling-specific work done.
	(use_existing_account_data_func): Conditionally add column
	detailing the status of how this new hierarchy merges into the
	existing one.
	(on_final_account_next): Check to ensure there are no
	account-hierarchy merge conflicts before allowing Next to final
	page.
	(balance_cell_data_func): Add new subtlety around opening-balance
	editing in the face of hierarachy-merging.
	(on_finish): Reorder dialog finishing to work around account-tree
	model bug, starting-balance-transaction creation, data-merging,
	when-completed callback creation.
	(gnc_ui_hierarchy_druid_hook): Add callback to create new
	account-page as consequence of new-file hook run.

	* src/gnome/dialog-new-user.c (after_hierarchy_druid): Create+use
	callback for new-user-dialog specific code.

	* src/gnome/glade/account.glade: Change "opening balances" page
	title, default dialog positioning hint (from none to parent-center).

	* src/gnome/druid-merge.[ch]
	(gnc_ui_qof_book_merge_druid): Remove hierarchy-druid wrapper.
	: remove un-used qof_book_merge_druid.

	* accounts/C/*: Add placeholder flag on relevant accounts.

2006-01-13  Derek Atkins  <derek@ihtfp.com>

	* src/gnome-utils/Makefile.am: revert 12296 and handle the
	  case of an svn checkout without .svn subdirs (gentoo ebuild).
	  In particular, we want to use $(srcdir)/gnc-svninfo.h
	  so that a build from a dist tarball has the svn version.

	* src/bin/overrides/gnucash
	* src/bin/overrides/gnucash-valgrind
	* src/bin/overrides/Makefile.am:
	  remove unnecessary override files that are no longer useful.

	* goffice/*/Makefile.am:
	* libgsf/*/Makefile.am:
	  don't install goffice and gsf headers.

	* configure.in: Properly set QOF_LIB_DIR et. al. for internal qof.

	* lib/libqof/qof/Makefile.am: qofla-dir.h depends on Makefile.
	  Make sure you rebuild qofla-dir.h when the Makefile changes,
	  which would imply re-configuration.  You never know, the
	  user might have changed --prefix which means you want to
	  rebuild the header.

2006-01-13  Neil Williams <linux@codehelp.co.uk>

	* src/bin/test/test-version : Using Derek's fix to
	resolve the test failure.

2006-01-13  Derek Atkins  <derek@ihtfp.com>

	* src/bin/overrides/gnucash-build-env.in:
	  Change core-utils to a gnc-module-dir so it loads both
	  the .scm and the .so properly.

r12337 | chris | 2006-01-12 20:25:12 -0500 (Thu, 12 Jan 2006) | 5 lines

   M /trunk/src/app-utils/Makefile.am
   M /trunk/src/app-utils/gnc-gettext-util.c
   M /trunk/src/app-utils/gnc-gettext-util.h
   M /trunk/src/app-utils/gw-app-utils-spec.scm
   D /trunk/src/app-utils/i18n.h.in
   M /trunk/src/bin/Makefile.am
   M /trunk/src/bin/gnucash-bin.c
   A /trunk/src/bin/i18n.h.in (from /trunk/src/app-utils/i18n.h.in:12334)
   M /trunk/src/scm/main.scm

   Move gnu-module init and gettext init from scm to C.
   Move i18n.h.in from src/app-utils to src/bin, where it is used.
   Remove unneeded gettext init code in src/app-utils

r12330 | chris | 2006-01-12 16:26:01 -0500 (Thu, 12 Jan 2006) | 6 lines

   M /trunk/src/backend/file/gnc-account-xml-v2.c
   M /trunk/src/backend/file/test/test-real-data.sh
   M /trunk/src/backend/file/test/test-xml-account.c

   Don't let deprecated tags overwrite data from newer tags.
   Avoid testing for match of deprecated tags.
   Warn about deprecated tags not being preserved.
   Plug another leak in test case.
   Make successful test-xml-account less verbose.

r12329 | chris | 2006-01-12 16:22:03 -0500 (Thu, 12 Jan 2006) | 3 lines

   M /trunk/src/backend/file/test/test-file-stuff.c

   Avoid creating new xml parser for each test file.
   This plugs a mem leak in the test case.

2006-01-12  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-tree-view-account.c: Remove the unnecessary
	explicit removal of the tree model and let the core GtkTreeView
	code do its thing.  Prevents a weird crash when canceling the
	transfer code.

2006-01-12  Derek Atkins  <derek@ihtfp.com>

	* configure.in:  add --enable-qof so build defaults to internal qof.

	* configure.in: fixes to make configure more quiet
	  - move PKG_CONFIG check early in the process
	  - use --silence-errors more
	* macros/pkg.m4: work around a pkg-config bug that outputs
	  errors to stderr even when you tell it to output to stdout.

2006-01-10  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-gnome-utils.c:
	* src/gnome-utils/dialog-utils.c: A couple of simple substitutions
	for deprecated functions.

	* src/gnome-utils/dialog-options.c: Use newer function for setting
	the width of a GtkSpinButton.

	* src/network-utils/Makefile.am:
	* src/gnome-utils/gnc-html.c:
	* src/gnome/top-level.c: The gnucash gpg networking code isn't
	called from anywhere.  No need to compile it as part of the build.

	* src/register/register-gnome/gnucash-cursor.c:
	* src/register/register-gnome/gnucash-item-edit.c:
	* src/register/register-gnome/gnucash-grid.c:
	* src/register/register-gnome/gnucash-header.c:
	* src/gnome-utils/gnc-dense-cal.c:
	* src/gnome-utils/gnc-main-window.c:
	* src/gnome-utils/dialog-utils.c:
	* src/gnome-utils/dialog-options.c: Replace deprecated functions
	with their current equivalent.

2006-01-10  Derek Atkins  <derek@ihtfp.com>

	* make-gnucash-potfiles.in: ignore dangling symlinks when
	  building po/POTFILES.in

2006-01-10  Christian Stimming  <stimming@tuhh.de>

	* accounts/nb/*, configure.in: Add account templates for Norwegian
	(Bokmal) language; by Tor Harald Thorland <linux@strigen.com>; not
	fully functional so far.

r12322 | chris | 2006-01-10 23:39:12 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/Account.c

   Factor-out cut-n-paste job from xaccCloneAccount{Simple}.

r12321 | chris | 2006-01-10 23:30:20 -0500 (Tue, 10 Jan 2006) | 3 lines

   M /trunk/src/engine/Account.c

   Convert account name, code and description to use string cache.
   Plus minor comments and tweaks.

r12319 | chris | 2006-01-10 23:27:02 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/lib/libqof/qof/gnc-engine-util.h

   Add CACHE_REPLACE(dst, src) macro for common case in string setters.

r12316 | chris | 2006-01-10 21:58:59 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/gnc-commodity.c

   Convert gnc-commodity to use vanilla string cache macros.

r12315 | chris | 2006-01-10 21:56:02 -0500 (Tue, 10 Jan 2006) | 3 lines

   M /trunk/lib/libqof/qof/gnc-engine-util.c
   M /trunk/lib/libqof/qof/gnc-engine-util.h

   Add const to gnc_string_cache_insert argument.
   Handle NULL values gracefully.

r12313 | chris | 2006-01-10 21:19:42 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/test/test-date.c

   Add commented-out test case demonstrating lack of year 2038 support.

r12311 | chris | 2006-01-10 16:42:55 -0500 (Tue, 10 Jan 2006) | 2 lines

   M /trunk/src/engine/gnc-commodity.c

   Plug memory leak of gnc_commodity_namespace->QofInstance; found w/ valgrind.

r12308 | chris | 2006-01-09 16:06:45 -0500 (Mon, 09 Jan 2006) | 2 lines

   M /trunk/src/engine/test/test-date.c

   Avoid testing dates near or after 2038, because the qof parsing
   functions fail.

r12306 | chris | 2006-01-08 22:33:46 -0500 (Sun, 08 Jan 2006) | 2 lines

   M /trunk/src/app-utils/gnc-ui-util.c
   M /trunk/src/app-utils/test/test-print-parse-amount.c

   Don't test numeric parsing for numbers that overflow, we'd fail.

2006-01-08  David Hampton  <hampton@employees.org>

	* src/gnome-utils/dialog-options.c: Add a button to clear the name
	of the currently selected file in a file chooser.

	* src/register/register-gnome/gnucash-item-list.c:
	* src/import-export/hbci/dialog-hbcitrans.c: The GTK2.4 headers
	are missing a named constant.

	* lib/goffice-0.0.4/goffice/glib24_26-compat.c: Fix a couple of
	compiler version issues.

2006-01-08  Derek Atkins  <derek@ihtfp.com>

	* Makefile.am: fix the dist-hook macro for po/POTFILES.in

2006-01-08  Neil Williams <linux@codehelp.co.uk>

	* src/import-export/qif-import/test/Makefile.am : OSX fix.
	* po/en_GB.po : (To assist the TP project,
	with help from Nigel Titley, GNU translator.)
	Remaining: 92 fuzzy translations, 1 untranslated message
	* . : Adding *.prj.bak to svn:ignore.

2006-01-08  Neil Williams <linux@codehelp.co.uk>

	* src/engine/Transaction.c : Even up ENTER and LEAVE
	calls.
	* src/gnome-utils/druid-gconf-setup.c : Typo fix.
	* src/gnome-utils/gnc-tree-model-budget.h : Doxygen tweak.
	* src/gnome/gnc-plugin-budget.c : Match ENTER with LEAVE
	* src/gnome/gnc-plugin-page-budget.h : Doxygen tweak.

2006-01-08  Christian Stimming  <stimming@tuhh.de>

	* src/gnome-utils/gnc-main-window.c: Add gnc workaround function
	for errorneous gtk_action_group_set_translation_domain. Fixes the
	statusbar-tooltip error mentioned on 2006-01-07. Filed in gtk as
	bug#326200.

2006-01-07  David Hampton  <hampton@employees.org>

	* src/report/standard-reports/account-summary.scm: Copy the table
	markup from an intermediate table to the final displayed table.
	
	* src/report/report-system/html-acct-table.scm: When building a
	html table from an account tree, apply markup to the "total" lines
	so that they use the right stylesheet colors.

	* src/report/standard-reports/portfolio.scm:
	* src/report/standard-reports/advanced-portfolio.scm: Fix the
	"share decimal places" option.

2006-01-07  Christian Stimming  <stimming@tuhh.de>

	* src/gnome/gnc-plugin-page-register.c,
	src/report/report-gnome/gnc-plugin-page-report.c: Add more
	tooltips to actions.

	* src/gnome-utils/gnc-main-window.c: Add display of a GtkAction's
	tooltip in the statusbar when the mouse is selection its menu
	item. Code copied from gtk+'s test/testmerge.c. Works fine, except
	that in non-C locales some "" tooltips are translated in a weird
	way. Maybe because "" is errorneously passed through gettext(),
	which will accidentally catch a wrong string from the po
	files. This needs to be fixed.

	* src/report/report-gnome/gnc-plugin-page-report.c: Rename "Save
	report" menu item to "Add report" according to IRC discussion with
	warlord.
	
	* autogen.sh: Move code from macros/autogen.sh to here to make it
	more obvious what happens. Add checks for all programs that are
	called, fixes bug#325721. However in principle the code wasn't
	changed, only cleaned up.

2006-01-07  David Hampton  <hampton@employees.org>

	* src/business/business-gnome/dialog-order.c:
	* src/business/business-gnome/dialog-date-close.c:
	* src/gnome-utils/gnc-druid-provider-file-gnome.[ch]: Remove some
	deprecated gnome functions.

	* src/bin/gnucash-valgrind.in:
	* src/bin/Makefile.am: Add a script to invoke the new gnucash.bin
	executable via valgrind.

	* src/gnome/window-main-summarybar.c: Performance enhancements.
	Remove the model from the combo box before clearing and
	repopulating it.

2006-01-06  David Hampton  <hampton@employees.org>

	* src/import-export/hbci/dialog-hbcitrans.[ch]: 
	* src/import-export/hbci/glade/hbci.glade:
	* src/import-export/hbci/gnc-hbci-transfer.c: Make the HBCI
	Transfer dialog work again using a GtkListStore.

r12278 | chris | 2006-01-06 17:28:38 -0500 (Fri, 06 Jan 2006) | 2 lines

   M /trunk/src/app-utils/gnc-ui-util.c
   M /trunk/src/app-utils/gnc-ui-util.h

   Fix floating point exception by checking for overflow.

r12273 | chris | 2006-01-06 16:31:22 -0500 (Fri, 06 Jan 2006) | 10 lines

   M /trunk/Makefile.am

   Fixes for `make check' in toplevel Makefile.am.

   Conditionally add symlink from ./gsf to ./lib/libgsf-1.12.3/gsf.

   Also, silence warning:
     /usr/share/automake-1.9/am/tags.am: ctags was already defined in
     condition !GNC_CTAGS_FILE, which is included in condition TRUE ...
     Makefile.am:138: ... `ctags' previously defined here

   and avoid possible `make dist' failure by added po/POTFILES.in to
   dist-hook.

r12271 | chris | 2006-01-05 21:49:27 -0500 (Thu, 05 Jan 2006) | 8 lines

   M /trunk/Makefile.am
   D /trunk/po/POTFILES.in

   Yet more build tweaks for .pot file generation.

   Remove po/POTFILES.in (again) from svn.  Since po/POTFILES.in is added
   to BUILT_SOURCES, it's auto-generated now whenever the `make all',
   `make check', or `make install' targets are processed, (but not
   recreated every time).  And `make pot' forces the recreation of
   po/POTFILES.in.  Hopefully, this will works even on OSX.

2006-01-04  David Hampton  <hampton@employees.org>

	* src/gnome-utils/ui/gnc-main-window-ui.xml:
	* src/gnome-utils/gnc-main-window.c: Add in some conditionally
	compiled hooks for turning callgrind on/off via the menus.

	* src/gnome/gnc-plugin-page-account-tree.c: Consolidate some
	common functionality.

	* src/register/register-gnome/combocell-gnome.c:
	* src/register/register-gnome/gnucash-item-list.[ch]:
	* src/register/ledger-core/split-register-load.c:
	* src/register/register-core/combocell.h: Load the entire data set
	into the combocell before enabling sorting.  Saves a tremendous
	amount of time.
	
	* src/backend/file/gnc-transaction-xml-v2.c:
	* lib/libqof/qof/gnc-numeric.c: A couple of performance tweaks.

r12252 | chris | 2006-01-03 18:49:39 -0500 (Tue, 03 Jan 2006) | 5 lines

   M /trunk/src/bin/Makefile.am
   A /trunk/src/bin/gnucash-bin.c
   A /trunk/src/bin/gnucash.in

   Invert the program entry point.

   'gnucash' is now a shell script that calls the executable
   'gnucash-bin' which uses libguile to load guile modules.

2006-01-03  Joshua Sled  <jsled@asynchronous.org>

	* gnc-sxed-window-ui.xml: Remove unreferenced `TransactionAction`.

	* dialog-sxsincelast.c (sxsld_disposition_changed): change the
	assertion into a simple return-if-fail due to apparent change in
	the calling order in gtk 2.x...

2006-01-03  David Hampton  <hampton@employees.org>

	* src/engine/Transaction.c: When setting the amount of a split,
	don't call gnc_numeric_convert on it if the split isn't assigned
	to an account. This reduces the time spent loading a data file.

	* src/business/business-gnome/glade/invoice.glade: Couple the
	radio buttons in the unpost dialog.

	* src/gnome/top-level.c:
	* src/gnome/dialog-totd.c:
	* src/gnome/glade/totd.glade: Revert the previous change and make
	the totd always float above all other GnuCash windows.

2006-01-02  David Hampton  <hampton@employees.org>

	* src/gnome/dialog-totd.c: Use the component manager to ensure
	there is only one totd dialog at a time.  Don't mark the dialog as
	transient (or type GTK_WINDOW_DIALOG) so that window managers
	won't make it float above all other GnuCash windows.

	* src/engine/Transaction.c: Fix test inverted by commit 12231.

	* src/gnome-utils/Makefile.am
	* src/gnome-utils/gnc-tree-model-example-account.[ch]: Remove
	unused files.

	* src/gnome/glade/account.glade:
	* src/gnome/druid-hierarchy.c: Use a GtkListStore for the example
	account categories instead of layering a custom selection model on
	a custom example account model.  The code is a lot simpler and has
	additional sorting capability. Do some rework on the druid
	layout.

	* src/gnome-utils/gnc-tree-model-selection.[ch]: Correct function
	name.  Add a comment.

2006-01-02  Derek Atkine  <derek@ihtfp.com>

	* src/gnome-utils/gnc-tree-view-account.c:
	* src/gnome/gnc-plugin-page-budget.c:
	  need to #include gkeyfile.h if we don't have glib26.

2006-01-02  David Hampton  <hampton@employees.org>

	* src/gnome-utils/gnc-tree-view.c: Use the right function to hide
	a tree column. Update a couple of debugging messages.

	* src/engine/gw-engine-spec.scm:
	* src/engine/gnc-commodity.[ch]: Initialize the qof instances in
	commodity namespaces.

r12232 | chris | 2006-01-01 19:37:02 -0500 (Sun, 01 Jan 2006) | 2 lines

   D /trunk/src/gnome/gncmod-budget.c

   Delete unused gncmod-budget.c.

r12231 | chris | 2006-01-01 17:26:15 -0500 (Sun, 01 Jan 2006) | 9 lines

   M /trunk/src/engine/Transaction.c
   M /trunk/src/engine/Transaction.h

  General clean-up in Transaction.[ch].

    * Regularization of 'trans' as variable name.
    * Whitespace and linewraps
    * lots of control-flow simplification
    * factor one chunk out into get_any_account()
    * Comment some things that are bogus or need improvement
	
